/*
  These C codes generated by Cpi version 2.0
  Copyright (C) 2019-2020 Alireza Rashti.
*/


#include "dg_header.h"

#define STR_LEN (99)

#define Read_v(name,stem) indx = strrchr(#name,'_');\
  if(indx){sprintf(fname,"%s%s",stem,indx);}\
  else{sprintf(fname,"%s",stem);} \
  const double *const name = patch->fields[Ind(fname)]->v;assert(name);


#define Write_v(name,stem) indx = strrchr(#name,'_');\
  if(indx){sprintf(fname,"%s%s",stem,indx);}\
  else{sprintf(fname,"%s",stem);} \
    free_coeffs(patch->fields[Ind(fname)]); \
    double *const name = patch->fields[Ind(fname)]->v; assert(name);



void Ricci_3d(Patch_T *const patch,const char *const ig,
              const char *const Chris,const char *const dChris,
              const char *const Ricci,const char *const trRicci);

void Ricci_3d(Patch_T *const patch,const char *const ig,
              const char *const Chris,const char *const dChris,
              const char *const Ricci,const char *const trRicci)
{
char fname[STR_LEN] = {'\0'};
const char *indx = 0;

  /* declaring: */
  Read_v(ig_U1U1,ig)
  Read_v(ig_U1U2,ig)
  Read_v(ig_U0U0,ig)
  Read_v(ig_U0U1,ig)
  Read_v(ig_U0U2,ig)
  Read_v(ig_U2U2,ig)
  Read_v(Chris_U2D2D2,Chris)
  Read_v(Chris_U0D1D1,Chris)
  Read_v(Chris_U2D1D1,Chris)
  Read_v(Chris_U0D1D2,Chris)
  Read_v(Chris_U0D0D2,Chris)
  Read_v(Chris_U0D0D1,Chris)
  Read_v(Chris_U0D0D0,Chris)
  Read_v(Chris_U2D1D2,Chris)
  Read_v(Chris_U2D0D1,Chris)
  Read_v(Chris_U1D2D2,Chris)
  Read_v(Chris_U2D0D0,Chris)
  Read_v(Chris_U2D0D2,Chris)
  Read_v(Chris_U1D1D2,Chris)
  Read_v(Chris_U1D0D2,Chris)
  Read_v(Chris_U1D0D1,Chris)
  Read_v(Chris_U1D0D0,Chris)
  Read_v(Chris_U0D2D2,Chris)
  Read_v(Chris_U1D1D1,Chris)
  Read_v(dChris_U1D0D0D1,dChris)
  Read_v(dChris_U0D1D1D0,dChris)
  Read_v(dChris_U1D0D0D2,dChris)
  Read_v(dChris_U1D0D0D0,dChris)
  Read_v(dChris_U2D1D1D2,dChris)
  Read_v(dChris_U2D1D1D0,dChris)
  Read_v(dChris_U2D1D1D1,dChris)
  Read_v(dChris_U0D1D1D2,dChris)
  Read_v(dChris_U2D0D0D1,dChris)
  Read_v(dChris_U2D1D2D1,dChris)
  Read_v(dChris_U2D1D2D0,dChris)
  Read_v(dChris_U2D1D2D2,dChris)
  Read_v(dChris_U0D2D2D0,dChris)
  Read_v(dChris_U0D2D2D1,dChris)
  Read_v(dChris_U0D2D2D2,dChris)
  Read_v(dChris_U2D0D2D1,dChris)
  Read_v(dChris_U1D2D2D1,dChris)
  Read_v(dChris_U1D2D2D0,dChris)
  Read_v(dChris_U1D2D2D2,dChris)
  Read_v(dChris_U2D0D2D2,dChris)
  Read_v(dChris_U0D0D0D0,dChris)
  Read_v(dChris_U0D0D0D1,dChris)
  Read_v(dChris_U0D0D0D2,dChris)
  Read_v(dChris_U1D1D2D2,dChris)
  Read_v(dChris_U2D0D0D2,dChris)
  Read_v(dChris_U2D0D2D0,dChris)
  Read_v(dChris_U0D0D2D2,dChris)
  Read_v(dChris_U0D1D1D1,dChris)
  Read_v(dChris_U0D0D2D0,dChris)
  Read_v(dChris_U0D0D2D1,dChris)
  Read_v(dChris_U2D2D2D1,dChris)
  Read_v(dChris_U2D0D1D2,dChris)
  Read_v(dChris_U2D0D1D1,dChris)
  Read_v(dChris_U2D0D1D0,dChris)
  Read_v(dChris_U1D1D2D0,dChris)
  Read_v(dChris_U0D0D1D1,dChris)
  Read_v(dChris_U0D0D1D0,dChris)
  Read_v(dChris_U2D2D2D0,dChris)
  Read_v(dChris_U0D0D1D2,dChris)
  Read_v(dChris_U0D1D2D2,dChris)
  Read_v(dChris_U0D1D2D1,dChris)
  Read_v(dChris_U0D1D2D0,dChris)
  Read_v(dChris_U1D0D1D0,dChris)
  Read_v(dChris_U1D0D1D1,dChris)
  Read_v(dChris_U1D0D1D2,dChris)
  Read_v(dChris_U1D1D2D1,dChris)
  Read_v(dChris_U2D2D2D2,dChris)
  Read_v(dChris_U1D1D1D1,dChris)
  Read_v(dChris_U1D1D1D0,dChris)
  Read_v(dChris_U1D1D1D2,dChris)
  Read_v(dChris_U2D0D0D0,dChris)
  Read_v(dChris_U1D0D2D2,dChris)
  Read_v(dChris_U1D0D2D1,dChris)
  Read_v(dChris_U1D0D2D0,dChris)
  Write_v(Ricci_D0D2,Ricci)
  Write_v(Ricci_D0D1,Ricci)
  Write_v(Ricci_D0D0,Ricci)
  Write_v(Ricci_D1D2,Ricci)
  Write_v(Ricci_D1D1,Ricci)
  Write_v(Ricci_D2D2,Ricci)
  Write_v(trR,trRicci)


  FOR_ALL_ijk
  {
  double Ric1_D0D0 = 
dChris_U0D0D0D0[ijk] + dChris_U1D0D0D1[ijk] + dChris_U2D0D0D2[ijk];

  double Ric1_D2D2 = 
dChris_U0D2D2D0[ijk] + dChris_U1D2D2D1[ijk] + dChris_U2D2D2D2[ijk];

  double Ric1_D1D2 = 
dChris_U0D1D2D0[ijk] + dChris_U1D1D2D1[ijk] + dChris_U2D1D2D2[ijk];

  double Ric1_D0D2 = 
dChris_U0D0D2D0[ijk] + dChris_U1D0D2D1[ijk] + dChris_U2D0D2D2[ijk];

  double Ric1_D0D1 = 
dChris_U0D0D1D0[ijk] + dChris_U1D0D1D1[ijk] + dChris_U2D0D1D2[ijk];

  double Ric1_D1D1 = 
dChris_U0D1D1D0[ijk] + dChris_U1D1D1D1[ijk] + dChris_U2D1D1D2[ijk];

  double Ric2_D2D2 = 
-dChris_U0D0D2D2[ijk] - dChris_U1D1D2D2[ijk] - dChris_U2D2D2D2[ijk];

  double Ric2_D0D0 = 
-dChris_U0D0D0D0[ijk] - dChris_U1D0D1D0[ijk] - dChris_U2D0D2D0[ijk];

  double Ric2_D0D2 = 
-dChris_U0D0D0D2[ijk] - dChris_U1D0D1D2[ijk] - dChris_U2D0D2D2[ijk];

  double Ric2_D1D2 = 
-dChris_U0D0D1D2[ijk] - dChris_U1D1D1D2[ijk] - dChris_U2D1D2D2[ijk];

  double Ric2_D1D1 = 
-dChris_U0D0D1D1[ijk] - dChris_U1D1D1D1[ijk] - dChris_U2D1D2D1[ijk];

  double Ric2_D0D1 = 
-dChris_U0D0D0D1[ijk] - dChris_U1D0D1D1[ijk] - dChris_U2D0D2D1[ijk];

  double Ric3_D1D1 = 
Chris_U0D0D0[ijk]*Chris_U0D1D1[ijk] + Chris_U0D0D1[ijk]*
Chris_U1D1D1[ijk] + Chris_U0D0D2[ijk]*Chris_U2D1D1[ijk] + 
Chris_U0D1D1[ijk]*Chris_U1D0D1[ijk] + Chris_U0D1D1[ijk]*
Chris_U2D0D2[ijk] + pow(Chris_U1D1D1[ijk], 2) + Chris_U1D1D1[ijk]*
Chris_U2D1D2[ijk] + Chris_U1D1D2[ijk]*Chris_U2D1D1[ijk] + 
Chris_U2D1D1[ijk]*Chris_U2D2D2[ijk];

  double Ric3_D1D2 = 
Chris_U0D0D0[ijk]*Chris_U0D1D2[ijk] + Chris_U0D0D1[ijk]*
Chris_U1D1D2[ijk] + Chris_U0D0D2[ijk]*Chris_U2D1D2[ijk] + 
Chris_U0D1D2[ijk]*Chris_U1D0D1[ijk] + Chris_U0D1D2[ijk]*
Chris_U2D0D2[ijk] + Chris_U1D1D1[ijk]*Chris_U1D1D2[ijk] + 2.0*
Chris_U1D1D2[ijk]*Chris_U2D1D2[ijk] + Chris_U2D1D2[ijk]*
Chris_U2D2D2[ijk];

  double Ric3_D0D1 = 
Chris_U0D0D0[ijk]*Chris_U0D0D1[ijk] + 2.0*Chris_U0D0D1[ijk]*
Chris_U1D0D1[ijk] + Chris_U0D0D1[ijk]*Chris_U2D0D2[ijk] + 
Chris_U0D0D2[ijk]*Chris_U2D0D1[ijk] + Chris_U1D0D1[ijk]*
Chris_U1D1D1[ijk] + Chris_U1D0D1[ijk]*Chris_U2D1D2[ijk] + 
Chris_U1D1D2[ijk]*Chris_U2D0D1[ijk] + Chris_U2D0D1[ijk]*
Chris_U2D2D2[ijk];

  double Ric3_D0D0 = 
pow(Chris_U0D0D0[ijk], 2) + Chris_U0D0D0[ijk]*Chris_U1D0D1[ijk] + 
Chris_U0D0D0[ijk]*Chris_U2D0D2[ijk] + Chris_U0D0D1[ijk]*
Chris_U1D0D0[ijk] + Chris_U0D0D2[ijk]*Chris_U2D0D0[ijk] + 
Chris_U1D0D0[ijk]*Chris_U1D1D1[ijk] + Chris_U1D0D0[ijk]*
Chris_U2D1D2[ijk] + Chris_U1D1D2[ijk]*Chris_U2D0D0[ijk] + 
Chris_U2D0D0[ijk]*Chris_U2D2D2[ijk];

  double Ric3_D0D2 = 
Chris_U0D0D0[ijk]*Chris_U0D0D2[ijk] + Chris_U0D0D1[ijk]*
Chris_U1D0D2[ijk] + Chris_U0D0D2[ijk]*Chris_U1D0D1[ijk] + 2.0*
Chris_U0D0D2[ijk]*Chris_U2D0D2[ijk] + Chris_U1D0D2[ijk]*
Chris_U1D1D1[ijk] + Chris_U1D0D2[ijk]*Chris_U2D1D2[ijk] + 
Chris_U1D1D2[ijk]*Chris_U2D0D2[ijk] + Chris_U2D0D2[ijk]*
Chris_U2D2D2[ijk];

  double Ric3_D2D2 = 
Chris_U0D0D0[ijk]*Chris_U0D2D2[ijk] + Chris_U0D0D1[ijk]*
Chris_U1D2D2[ijk] + Chris_U0D0D2[ijk]*Chris_U2D2D2[ijk] + 
Chris_U0D2D2[ijk]*Chris_U1D0D1[ijk] + Chris_U0D2D2[ijk]*
Chris_U2D0D2[ijk] + Chris_U1D1D1[ijk]*Chris_U1D2D2[ijk] + 
Chris_U1D1D2[ijk]*Chris_U2D2D2[ijk] + Chris_U1D2D2[ijk]*
Chris_U2D1D2[ijk] + pow(Chris_U2D2D2[ijk], 2);

  double Ric4_D0D0 = 
-pow(Chris_U0D0D0[ijk], 2) - 2.0*Chris_U0D0D1[ijk]*Chris_U1D0D0[ijk] - 
2.0*Chris_U0D0D2[ijk]*Chris_U2D0D0[ijk] - pow(Chris_U1D0D1[ijk], 2) - 
2.0*Chris_U1D0D2[ijk]*Chris_U2D0D1[ijk] - pow(Chris_U2D0D2[ijk], 2);

  double Ric4_D0D1 = 
-Chris_U0D0D0[ijk]*Chris_U0D0D1[ijk] - Chris_U0D0D1[ijk]*
Chris_U1D0D1[ijk] - Chris_U0D0D2[ijk]*Chris_U2D0D1[ijk] - 
Chris_U0D1D1[ijk]*Chris_U1D0D0[ijk] - Chris_U0D1D2[ijk]*
Chris_U2D0D0[ijk] - Chris_U1D0D1[ijk]*Chris_U1D1D1[ijk] - 
Chris_U1D0D2[ijk]*Chris_U2D1D1[ijk] - Chris_U1D1D2[ijk]*
Chris_U2D0D1[ijk] - Chris_U2D0D2[ijk]*Chris_U2D1D2[ijk];

  double Ric4_D0D2 = 
-Chris_U0D0D0[ijk]*Chris_U0D0D2[ijk] - Chris_U0D0D1[ijk]*
Chris_U1D0D2[ijk] - Chris_U0D0D2[ijk]*Chris_U2D0D2[ijk] - 
Chris_U0D1D2[ijk]*Chris_U1D0D0[ijk] - Chris_U0D2D2[ijk]*
Chris_U2D0D0[ijk] - Chris_U1D0D1[ijk]*Chris_U1D1D2[ijk] - 
Chris_U1D0D2[ijk]*Chris_U2D1D2[ijk] - Chris_U1D2D2[ijk]*
Chris_U2D0D1[ijk] - Chris_U2D0D2[ijk]*Chris_U2D2D2[ijk];

  double Ric4_D1D1 = 
-pow(Chris_U0D0D1[ijk], 2) - 2.0*Chris_U0D1D1[ijk]*Chris_U1D0D1[ijk] - 
2.0*Chris_U0D1D2[ijk]*Chris_U2D0D1[ijk] - pow(Chris_U1D1D1[ijk], 2) - 
2.0*Chris_U1D1D2[ijk]*Chris_U2D1D1[ijk] - pow(Chris_U2D1D2[ijk], 2);

  double Ric4_D1D2 = 
-Chris_U0D0D1[ijk]*Chris_U0D0D2[ijk] - Chris_U0D1D1[ijk]*
Chris_U1D0D2[ijk] - Chris_U0D1D2[ijk]*Chris_U1D0D1[ijk] - 
Chris_U0D1D2[ijk]*Chris_U2D0D2[ijk] - Chris_U0D2D2[ijk]*
Chris_U2D0D1[ijk] - Chris_U1D1D1[ijk]*Chris_U1D1D2[ijk] - 
Chris_U1D1D2[ijk]*Chris_U2D1D2[ijk] - Chris_U1D2D2[ijk]*
Chris_U2D1D1[ijk] - Chris_U2D1D2[ijk]*Chris_U2D2D2[ijk];

  double Ric4_D2D2 = 
-pow(Chris_U0D0D2[ijk], 2) - 2.0*Chris_U0D1D2[ijk]*Chris_U1D0D2[ijk] - 
2.0*Chris_U0D2D2[ijk]*Chris_U2D0D2[ijk] - pow(Chris_U1D1D2[ijk], 2) - 
2.0*Chris_U1D2D2[ijk]*Chris_U2D1D2[ijk] - pow(Chris_U2D2D2[ijk], 2);

  double Ric_D1D1 = 
Ric1_D1D1 + Ric2_D1D1 + Ric3_D1D1 + Ric4_D1D1;

  double Ric_D1D2 = 
Ric1_D1D2 + Ric2_D1D2 + Ric3_D1D2 + Ric4_D1D2;

  double Ric_D2D2 = 
Ric1_D2D2 + Ric2_D2D2 + Ric3_D2D2 + Ric4_D2D2;

  double Ric_D0D1 = 
Ric1_D0D1 + Ric2_D0D1 + Ric3_D0D1 + Ric4_D0D1;

  double Ric_D0D0 = 
Ric1_D0D0 + Ric2_D0D0 + Ric3_D0D0 + Ric4_D0D0;

  double Ric_D0D2 = 
Ric1_D0D2 + Ric2_D0D2 + Ric3_D0D2 + Ric4_D0D2;

  double R = 
Ric_D0D0*ig_U0U0[ijk] + 2.0*Ric_D0D1*ig_U0U1[ijk] + 2.0*Ric_D0D2*
ig_U0U2[ijk] + Ric_D1D1*ig_U1U1[ijk] + 2.0*Ric_D1D2*ig_U1U2[ijk] +
Ric_D2D2*ig_U2U2[ijk];

trR[ijk] = R;

  /* populating: */
  Ricci_D0D2[ijk] = Ric_D0D2;
  Ricci_D0D1[ijk] = Ric_D0D1;
  Ricci_D0D0[ijk] = Ric_D0D0;
  Ricci_D1D2[ijk] = Ric_D1D2;
  Ricci_D1D1[ijk] = Ric_D1D1;
  Ricci_D2D2[ijk] = Ric_D2D2;
  }
}
