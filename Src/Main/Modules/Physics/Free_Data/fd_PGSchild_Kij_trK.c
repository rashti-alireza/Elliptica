/*
  These C codes generated by Cpi version 2.0
  Copyright (C) 2019-2020 Alireza Rashti.
*/


#include "fd_header.h"


void fd_Kij_trK_PGSchild(Patch_T *const patch,
 const char *const dbeta,const char *const Kij,
 const char *const trK);

void fd_Kij_trK_PGSchild(Patch_T *const patch,
 const char *const dbeta,const char *const Kij,
 const char *const trK)
{
  const double alpha = 1.;


  /* declaring: */
  READ_v_STEM(dBeta_U2D2,dbeta)
  READ_v_STEM(dBeta_U2D0,dbeta)
  READ_v_STEM(dBeta_U2D1,dbeta)
  READ_v_STEM(dBeta_U0D0,dbeta)
  READ_v_STEM(dBeta_U1D1,dbeta)
  READ_v_STEM(dBeta_U0D1,dbeta)
  READ_v_STEM(dBeta_U0D2,dbeta)
  READ_v_STEM(dBeta_U1D2,dbeta)
  READ_v_STEM(dBeta_U1D0,dbeta)
  REALLOC_v_WRITE_v_STEM(Kij_D2D2,Kij)
  REALLOC_v_WRITE_v_STEM(Kij_D0D1,Kij)
  REALLOC_v_WRITE_v_STEM(Kij_D0D0,Kij)
  REALLOC_v_WRITE_v_STEM(Kij_D0D2,Kij)
  REALLOC_v_WRITE_v_STEM(Kij_D1D1,Kij)
  REALLOC_v_WRITE_v_STEM(Kij_D1D2,Kij)
  REALLOC_v_WRITE_v_STEM(trKij,trK)


FOR_ALL_ijk
{
  double pgKij_D0D0 = 
dBeta_U0D0[ijk]/alpha;

  double pgKij_D2D2 = 
dBeta_U2D2[ijk]/alpha;

  double pgKij_D1D1 = 
dBeta_U1D1[ijk]/alpha;

  double pgKij_D0D1 = 
(1.0/2.0)*(dBeta_U0D1[ijk] + dBeta_U1D0[ijk])/alpha;

  double pgKij_D0D2 = 
(1.0/2.0)*(dBeta_U0D2[ijk] + dBeta_U2D0[ijk])/alpha;

  double pgKij_D1D2 = 
(1.0/2.0)*(dBeta_U1D2[ijk] + dBeta_U2D1[ijk])/alpha;

  double trk = 
pgKij_D0D0 + pgKij_D1D1 + pgKij_D2D2;


  /* populating: */
  Kij_D2D2[ijk] = pgKij_D2D2;
  Kij_D0D1[ijk] = pgKij_D0D1;
  Kij_D0D0[ijk] = pgKij_D0D0;
  Kij_D0D2[ijk] = pgKij_D0D2;
  Kij_D1D1[ijk] = pgKij_D1D1;
  Kij_D1D2[ijk] = pgKij_D1D2;
trKij[ijk] = trk;
}
}
