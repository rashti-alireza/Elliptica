/*
  These C codes generated by Cpi version 3.0
  Copyright (C) 2019-2023 Alireza Rashti.
*/


#include "bh_header.h"

double bh_calculate_expansion_on_AH(Physics_T *const phys);

double bh_calculate_expansion_on_AH(Physics_T *const phys)
{
 FUNC_TIC
 Grid_T *const grid = mygrid(phys,Ftype("BH_around_IB"));
 double max = 0.;

 FOR_ALL_p(grid->np)
 {
 Patch_T *patch = grid->patch[p];
 const Uint nX  = patch->n[0];
 const Uint nY  = patch->n[1];
 const Uint k   = 0;

 if (patch->coordsys != CubedSpherical)  Error0(NO_OPTION);

  READ_v_UNUSED(AConfIJ_U0U0)
  READ_v_UNUSED(AConfIJ_U0U1)
  READ_v_UNUSED(AConfIJ_U0U2)
  READ_v_UNUSED(AConfIJ_U1U1)
  READ_v_UNUSED(AConfIJ_U1U2)
  READ_v_UNUSED(AConfIJ_U2U2)
  READ_v_UNUSED(psi)
  READ_v_UNUSED(dpsi_D0)
  READ_v_UNUSED(dpsi_D1)
  READ_v_UNUSED(dpsi_D2)
  READ_v_UNUSED(trK)
  READ_v_UNUSED(bh_sConf_U0)
  READ_v_UNUSED(bh_sConf_U1)
  READ_v_UNUSED(bh_sConf_U2)
  READ_v_UNUSED(dbh_sConf_U0D0)
  READ_v_UNUSED(dbh_sConf_U0D1)
  READ_v_UNUSED(dbh_sConf_U0D2)
  READ_v_UNUSED(dbh_sConf_U1D0)
  READ_v_UNUSED(dbh_sConf_U1D1)
  READ_v_UNUSED(dbh_sConf_U1D2)
  READ_v_UNUSED(dbh_sConf_U2D0)
  READ_v_UNUSED(dbh_sConf_U2D1)
  READ_v_UNUSED(dbh_sConf_U2D2)
  READ_v_UNUSED(gConf_D0D0)
  READ_v_UNUSED(gConf_D0D1)
  READ_v_UNUSED(gConf_D0D2)
  READ_v_UNUSED(gConf_D1D1)
  READ_v_UNUSED(gConf_D1D2)
  READ_v_UNUSED(gConf_D2D2)
  READ_v_UNUSED(ChrisConf_U0D0D0)
  READ_v_UNUSED(ChrisConf_U0D0D1)
  READ_v_UNUSED(ChrisConf_U0D0D2)
  READ_v_UNUSED(ChrisConf_U0D1D1)
  READ_v_UNUSED(ChrisConf_U0D1D2)
  READ_v_UNUSED(ChrisConf_U0D2D2)
  READ_v_UNUSED(ChrisConf_U1D0D0)
  READ_v_UNUSED(ChrisConf_U1D0D1)
  READ_v_UNUSED(ChrisConf_U1D0D2)
  READ_v_UNUSED(ChrisConf_U1D1D1)
  READ_v_UNUSED(ChrisConf_U1D1D2)
  READ_v_UNUSED(ChrisConf_U1D2D2)
  READ_v_UNUSED(ChrisConf_U2D0D0)
  READ_v_UNUSED(ChrisConf_U2D0D1)
  READ_v_UNUSED(ChrisConf_U2D0D2)
  READ_v_UNUSED(ChrisConf_U2D1D1)
  READ_v_UNUSED(ChrisConf_U2D1D2)
  READ_v_UNUSED(ChrisConf_U2D2D2)
 for (Uint i = 0; i < nX; ++i)
 for (Uint j = 0; j < nY; ++j)
 {
 Uint ijk = i_j_k_to_ijk(patch->n,i,j,k);

  double DisConfI =
ChrisConf_U0D0D0[ijk]*bh_sConf_U0[ijk] + ChrisConf_U0D0D1[ijk]*
bh_sConf_U1[ijk] + ChrisConf_U0D0D2[ijk]*bh_sConf_U2[ijk] +
ChrisConf_U1D0D1[ijk]*bh_sConf_U0[ijk] + ChrisConf_U1D1D1[ijk]*
bh_sConf_U1[ijk] + ChrisConf_U1D1D2[ijk]*bh_sConf_U2[ijk] +
ChrisConf_U2D0D2[ijk]*bh_sConf_U0[ijk] + ChrisConf_U2D1D2[ijk]*
bh_sConf_U1[ijk] + ChrisConf_U2D2D2[ijk]*bh_sConf_U2[ijk] +
dbh_sConf_U0D0[ijk] + dbh_sConf_U1D1[ijk] + dbh_sConf_U2D2[ijk];

  double Theta =
(1.0/4.0)*DisConfI*psi[ijk] + bh_sConf_U0[ijk]*dpsi_D0[ijk] +
bh_sConf_U1[ijk]*dpsi_D1[ijk] + bh_sConf_U2[ijk]*dpsi_D2[ijk] - 1.0/6.0*
pow(psi[ijk], 3)*trK[ijk] + (1.0/4.0)*(AConfIJ_U0U0[ijk]*
pow(bh_sConf_U0[ijk], 2)*pow(gConf_D0D0[ijk], 2) + 2.0*
AConfIJ_U0U0[ijk]*bh_sConf_U0[ijk]*bh_sConf_U1[ijk]*gConf_D0D0[ijk]*
gConf_D0D1[ijk] + 2.0*AConfIJ_U0U0[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U2[ijk]*gConf_D0D0[ijk]*gConf_D0D2[ijk] + AConfIJ_U0U0[ijk]*
pow(bh_sConf_U1[ijk], 2)*pow(gConf_D0D1[ijk], 2) + 2.0*
AConfIJ_U0U0[ijk]*bh_sConf_U1[ijk]*bh_sConf_U2[ijk]*gConf_D0D1[ijk]*
gConf_D0D2[ijk] + AConfIJ_U0U0[ijk]*pow(bh_sConf_U2[ijk], 2)*
pow(gConf_D0D2[ijk], 2) + 2.0*AConfIJ_U0U1[ijk]*pow(bh_sConf_U0[ijk], 2)*
gConf_D0D0[ijk]*gConf_D0D1[ijk] + 2.0*AConfIJ_U0U1[ijk]*
bh_sConf_U0[ijk]*bh_sConf_U1[ijk]*gConf_D0D0[ijk]*gConf_D1D1[ijk] + 2.0*
AConfIJ_U0U1[ijk]*bh_sConf_U0[ijk]*bh_sConf_U1[ijk]*
pow(gConf_D0D1[ijk], 2) + 2.0*AConfIJ_U0U1[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U2[ijk]*gConf_D0D0[ijk]*gConf_D1D2[ijk] + 2.0*
AConfIJ_U0U1[ijk]*bh_sConf_U0[ijk]*bh_sConf_U2[ijk]*gConf_D0D1[ijk]*
gConf_D0D2[ijk] + 2.0*AConfIJ_U0U1[ijk]*pow(bh_sConf_U1[ijk], 2)*
gConf_D0D1[ijk]*gConf_D1D1[ijk] + 2.0*AConfIJ_U0U1[ijk]*
bh_sConf_U1[ijk]*bh_sConf_U2[ijk]*gConf_D0D1[ijk]*gConf_D1D2[ijk] + 2.0*
AConfIJ_U0U1[ijk]*bh_sConf_U1[ijk]*bh_sConf_U2[ijk]*gConf_D0D2[ijk]*
gConf_D1D1[ijk] + 2.0*AConfIJ_U0U1[ijk]*pow(bh_sConf_U2[ijk], 2)*
gConf_D0D2[ijk]*gConf_D1D2[ijk] + 2.0*AConfIJ_U0U2[ijk]*
pow(bh_sConf_U0[ijk], 2)*gConf_D0D0[ijk]*gConf_D0D2[ijk] + 2.0*
AConfIJ_U0U2[ijk]*bh_sConf_U0[ijk]*bh_sConf_U1[ijk]*gConf_D0D0[ijk]*
gConf_D1D2[ijk] + 2.0*AConfIJ_U0U2[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U1[ijk]*gConf_D0D1[ijk]*gConf_D0D2[ijk] + 2.0*
AConfIJ_U0U2[ijk]*bh_sConf_U0[ijk]*bh_sConf_U2[ijk]*gConf_D0D0[ijk]*
gConf_D2D2[ijk] + 2.0*AConfIJ_U0U2[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U2[ijk]*pow(gConf_D0D2[ijk], 2) + 2.0*AConfIJ_U0U2[ijk]*
pow(bh_sConf_U1[ijk], 2)*gConf_D0D1[ijk]*gConf_D1D2[ijk] + 2.0*
AConfIJ_U0U2[ijk]*bh_sConf_U1[ijk]*bh_sConf_U2[ijk]*gConf_D0D1[ijk]*
gConf_D2D2[ijk] + 2.0*AConfIJ_U0U2[ijk]*bh_sConf_U1[ijk]*
bh_sConf_U2[ijk]*gConf_D0D2[ijk]*gConf_D1D2[ijk] + 2.0*
AConfIJ_U0U2[ijk]*pow(bh_sConf_U2[ijk], 2)*gConf_D0D2[ijk]*
gConf_D2D2[ijk] + AConfIJ_U1U1[ijk]*pow(bh_sConf_U0[ijk], 2)*
pow(gConf_D0D1[ijk], 2) + 2.0*AConfIJ_U1U1[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U1[ijk]*gConf_D0D1[ijk]*gConf_D1D1[ijk] + 2.0*
AConfIJ_U1U1[ijk]*bh_sConf_U0[ijk]*bh_sConf_U2[ijk]*gConf_D0D1[ijk]*
gConf_D1D2[ijk] + AConfIJ_U1U1[ijk]*pow(bh_sConf_U1[ijk], 2)*
pow(gConf_D1D1[ijk], 2) + 2.0*AConfIJ_U1U1[ijk]*bh_sConf_U1[ijk]*
bh_sConf_U2[ijk]*gConf_D1D1[ijk]*gConf_D1D2[ijk] + AConfIJ_U1U1[ijk]*
pow(bh_sConf_U2[ijk], 2)*pow(gConf_D1D2[ijk], 2) + 2.0*
AConfIJ_U1U2[ijk]*pow(bh_sConf_U0[ijk], 2)*gConf_D0D1[ijk]*
gConf_D0D2[ijk] + 2.0*AConfIJ_U1U2[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U1[ijk]*gConf_D0D1[ijk]*gConf_D1D2[ijk] + 2.0*
AConfIJ_U1U2[ijk]*bh_sConf_U0[ijk]*bh_sConf_U1[ijk]*gConf_D0D2[ijk]*
gConf_D1D1[ijk] + 2.0*AConfIJ_U1U2[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U2[ijk]*gConf_D0D1[ijk]*gConf_D2D2[ijk] + 2.0*
AConfIJ_U1U2[ijk]*bh_sConf_U0[ijk]*bh_sConf_U2[ijk]*gConf_D0D2[ijk]*
gConf_D1D2[ijk] + 2.0*AConfIJ_U1U2[ijk]*pow(bh_sConf_U1[ijk], 2)*
gConf_D1D1[ijk]*gConf_D1D2[ijk] + 2.0*AConfIJ_U1U2[ijk]*
bh_sConf_U1[ijk]*bh_sConf_U2[ijk]*gConf_D1D1[ijk]*gConf_D2D2[ijk] + 2.0*
AConfIJ_U1U2[ijk]*bh_sConf_U1[ijk]*bh_sConf_U2[ijk]*
pow(gConf_D1D2[ijk], 2) + 2.0*AConfIJ_U1U2[ijk]*pow(bh_sConf_U2[ijk], 2)*
gConf_D1D2[ijk]*gConf_D2D2[ijk] + AConfIJ_U2U2[ijk]*
pow(bh_sConf_U0[ijk], 2)*pow(gConf_D0D2[ijk], 2) + 2.0*
AConfIJ_U2U2[ijk]*bh_sConf_U0[ijk]*bh_sConf_U1[ijk]*gConf_D0D2[ijk]*
gConf_D1D2[ijk] + 2.0*AConfIJ_U2U2[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U2[ijk]*gConf_D0D2[ijk]*gConf_D2D2[ijk] + AConfIJ_U2U2[ijk]*
pow(bh_sConf_U1[ijk], 2)*pow(gConf_D1D2[ijk], 2) + 2.0*
AConfIJ_U2U2[ijk]*bh_sConf_U1[ijk]*bh_sConf_U2[ijk]*gConf_D1D2[ijk]*
gConf_D2D2[ijk] + AConfIJ_U2U2[ijk]*pow(bh_sConf_U2[ijk], 2)*
pow(gConf_D2D2[ijk], 2))/pow(psi[ijk], 3);


  Theta = fabs(Theta);
  max = (max < Theta ? Theta: max);
 }
 }
 FUNC_TOC
 return max;
}
