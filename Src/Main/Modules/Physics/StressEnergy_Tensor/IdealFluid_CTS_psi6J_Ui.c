/*
  These C codes generated by Cpi version 1.0
  Copyright (C) 2019 Alireza Rashti.
*/


#include "IdealFluid_CTS_lib.h"


void Tij_IF_CTS_psi6J_Ui(Patch_T *const patch)
{
  if (!IsItNSPatch(patch))
  {
    if (_Ind("_J_U0") >= 0)
    {
      PREP_FIELD(_J_U0)
      UNUSED(_J_U0)
    }
    if (_Ind("_J_U1") >= 0)
    {
      PREP_FIELD(_J_U1)
      UNUSED(_J_U1)
    }
    if (_Ind("_J_U2") >= 0)
    {
      PREP_FIELD(_J_U2)
      UNUSED(_J_U2)
    }
    return;
  }
  const unsigned nn = patch->nn;
  unsigned ijk;

  /* declaring: */
  GET_FIELD(_gammaI_U0U2)
  GET_FIELD(_gammaI_U0U0)
  GET_FIELD(_gammaI_U0U1)
  GET_FIELD(_gammaI_U1U2)
  GET_FIELD(_gammaI_U1U1)
  GET_FIELD(_gammaI_U2U2)
  GET_FIELD(rho0)
  GET_FIELD(W_U1)
  GET_FIELD(W_U0)
  GET_FIELD(W_U2)
  GET_FIELD(dphi_D2)
  GET_FIELD(dphi_D1)
  GET_FIELD(dphi_D0)
  PREP_FIELD(_J_U0)
  PREP_FIELD(_J_U1)
  PREP_FIELD(_J_U2)
  GET_FIELD(eta)
  GET_FIELD(psi)
  GET_FIELD(u0)


  for(ijk = 0; ijk < nn; ++ijk)
  {
  double alpha = 
eta[ijk]/psi[ijk];

  double psim4 = 
pow(psi[ijk], -4);

  double psi6 = 
pow(psi[ijk], 6);

  double j_u_U0 = 
alpha*psi6*rho0[ijk]*u0[ijk]*(W_U0[ijk] + psim4*(_gammaI_U0U0[ijk]*
dphi_D0[ijk] + _gammaI_U0U1[ijk]*dphi_D1[ijk] + _gammaI_U0U2[ijk]*
dphi_D2[ijk]));

  double j_u_U1 = 
alpha*psi6*rho0[ijk]*u0[ijk]*(W_U1[ijk] + psim4*(_gammaI_U0U1[ijk]*
dphi_D0[ijk] + _gammaI_U1U1[ijk]*dphi_D1[ijk] + _gammaI_U1U2[ijk]*
dphi_D2[ijk]));

  double j_u_U2 = 
alpha*psi6*rho0[ijk]*u0[ijk]*(W_U2[ijk] + psim4*(_gammaI_U0U2[ijk]*
dphi_D0[ijk] + _gammaI_U1U2[ijk]*dphi_D1[ijk] + _gammaI_U2U2[ijk]*
dphi_D2[ijk]));


  /* populating: */
  _J_U0[ijk] = j_u_U0;
  _J_U1[ijk] = j_u_U1;
  _J_U2[ijk] = j_u_U2;
  }
}
