/*
  These C codes generated by Cpi version 3.0
  Copyright (C) 2019-2022 Alireza Rashti.
*/


#include "Tij_header.h"


void Tij_NS_IF_XCTS_gConf_psi6J_Ui(Patch_T *const patch,EoS_T *const eos)
{
  READ_v(igConf_U0U0)
  READ_v(igConf_U0U1)
  READ_v(igConf_U0U2)
  READ_v(igConf_U1U1)
  READ_v(igConf_U1U2)
  READ_v(igConf_U2U2)
  READ_v(enthalpy)
  READ_v(rho0)
  READ_v(W_U0)
  READ_v(W_U1)
  READ_v(W_U2)
  READ_v(dphi_D0)
  READ_v(dphi_D1)
  READ_v(dphi_D2)
  READ_v(alphaPsi)
  READ_v(psi)
  READ_v(u0)
  REALLOC_v_WRITE_v(JConf_U0)
  REALLOC_v_WRITE_v(JConf_U1)
  REALLOC_v_WRITE_v(JConf_U2)
  REALLOC_v_WRITE_v(JConfP_U0)
  REALLOC_v_WRITE_v(JConfP_U1)
  REALLOC_v_WRITE_v(JConfP_U2)
  REALLOC_v_WRITE_v(JConfC)
FOR_ALL_ijk
{
  eos->h    = enthalpy[ijk];
  double p  = eos->pressure(eos);
  double e0 = eos->specific_internal_energy(eos);
  double alpha =
alphaPsi[ijk]/psi[ijk];

  double psim4 =
pow(psi[ijk], -4);

  double psi6 =
pow(psi[ijk], 6);

  double j_u_U0 =
alpha*psi6*rho0[ijk]*u0[ijk]*(W_U0[ijk] + psim4*(dphi_D0[ijk]*
igConf_U0U0[ijk] + dphi_D1[ijk]*igConf_U0U1[ijk] + dphi_D2[ijk]*
igConf_U0U2[ijk]));

  double j_u_U1 =
alpha*psi6*rho0[ijk]*u0[ijk]*(W_U1[ijk] + psim4*(dphi_D0[ijk]*
igConf_U0U1[ijk] + dphi_D1[ijk]*igConf_U1U1[ijk] + dphi_D2[ijk]*
igConf_U1U2[ijk]));

  double j_u_U2 =
alpha*psi6*rho0[ijk]*u0[ijk]*(W_U2[ijk] + psim4*(dphi_D0[ijk]*
igConf_U0U2[ijk] + dphi_D1[ijk]*igConf_U1U2[ijk] + dphi_D2[ijk]*
igConf_U2U2[ijk]));


  JConf_U0[ijk] = j_u_U0;
  JConf_U1[ijk] = j_u_U1;
  JConf_U2[ijk] = j_u_U2;
  double p_o_rho0 = enthalpy[ijk] - 1. - e0;
  double jp_u_U0 =
alpha*p*psi6*u0[ijk]*(W_U0[ijk] + psim4*(dphi_D0[ijk]*igConf_U0U0[ijk] +
dphi_D1[ijk]*igConf_U0U1[ijk] + dphi_D2[ijk]*igConf_U0U2[ijk]));

  double jp_u_U1 =
alpha*p*psi6*u0[ijk]*(W_U1[ijk] + psim4*(dphi_D0[ijk]*igConf_U0U1[ijk] +
dphi_D1[ijk]*igConf_U1U1[ijk] + dphi_D2[ijk]*igConf_U1U2[ijk]));

  double jp_u_U2 =
alpha*p*psi6*u0[ijk]*(W_U2[ijk] + psim4*(dphi_D0[ijk]*igConf_U0U2[ijk] +
dphi_D1[ijk]*igConf_U1U2[ijk] + dphi_D2[ijk]*igConf_U2U2[ijk]));


  JConfP_U0[ijk] = jp_u_U0;
  JConfP_U1[ijk] = jp_u_U1;
  JConfP_U2[ijk] = jp_u_U2;
  JConfC[ijk] = p_o_rho0;
}
}
