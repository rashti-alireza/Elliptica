/*
  These C codes generated by Cpi version 3.0
  Copyright (C) 2019-2023 Alireza Rashti.
*/


#include "Tij_header.h"


void Tij_NS_IF_XCTS_gConf_psi6E(Patch_T *const patch,EoS_T *const eos)
{
  READ_v(enthalpy)
  READ_v(alphaPsi)
  READ_v(u0)
  READ_v(psi)
  READ_v(rho0)
  READ_v(e0)
  REALLOC_v_WRITE_v(EConf)
  REALLOC_v_WRITE_v(EConfP)
  REALLOC_v_WRITE_v(EConfC)
FOR_ALL_ijk
{
  eos->h    = enthalpy[ijk];
  double p  = eos->pressure(eos);
  double alpha =
alphaPsi[ijk]/psi[ijk];

  double psi6 =
pow(psi[ijk], 6);

  double Ebar =
psi6*(pow(alpha, 2)*enthalpy[ijk]*rho0[ijk]*pow(u0[ijk], 2) -
p);

  EConf[ijk] = Ebar;
  double p_o_rho0 =
-e0[ijk] + enthalpy[ijk] - 1.0;

  double EbarP =
p*psi6*(pow(alpha, 2)*enthalpy[ijk]*pow(u0[ijk], 2) -
p_o_rho0);

  EConfP[ijk] = EbarP;
  EConfC[ijk] = p_o_rho0;
}
}
