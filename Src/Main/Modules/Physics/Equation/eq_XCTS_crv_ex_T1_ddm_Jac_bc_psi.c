/*
  These C codes generated by Cpi version 3.0
  Copyright (C) 2019-2021 Alireza Rashti.
*/


#include "eq_header.h"
#include "maths_equation_solvings_lib.h"

void *eq_XCTS_curve_exc_T1_ddm_jacobian_bc_psi(void *vp1,void *vp2);
void *eq_XCTS_curve_exc_T1_ddm_jacobian_bc_psi(void *vp1,void *vp2)
{
  DDM_SCHUR_JACOBIAN_BC_DECLARE
  Uint ijk,lmn;/* for Jacobian entries J[ijk][lmn] */
  const double kd[2] = {0.,1.};/* Kronecker delta */

  Header_Jacobian
  READ_v(psi)
  READ_v(trK)
  READ_v_UNUSED(AConfIJ_U0U0)
  READ_v_UNUSED(AConfIJ_U0U1)
  READ_v_UNUSED(AConfIJ_U0U2)
  READ_v_UNUSED(AConfIJ_U1U1)
  READ_v_UNUSED(AConfIJ_U1U2)
  READ_v_UNUSED(AConfIJ_U2U2)
  READ_v(dpsi_D0)
  READ_v(dpsi_D1)
  READ_v(dpsi_D2)
  READ_v_UNUSED(gConf_D0D0)
  READ_v_UNUSED(gConf_D0D1)
  READ_v_UNUSED(gConf_D0D2)
  READ_v_UNUSED(gConf_D1D1)
  READ_v_UNUSED(gConf_D1D2)
  READ_v_UNUSED(gConf_D2D2)
  READ_v(bh_sConf_U0)
  READ_v(bh_sConf_U1)
  READ_v(bh_sConf_U2)
  READ_v_UNUSED(dbh_sConf_U0D0)
  READ_v_UNUSED(dbh_sConf_U0D1)
  READ_v_UNUSED(dbh_sConf_U0D2)
  READ_v_UNUSED(dbh_sConf_U1D0)
  READ_v_UNUSED(dbh_sConf_U1D1)
  READ_v_UNUSED(dbh_sConf_U1D2)
  READ_v_UNUSED(dbh_sConf_U2D0)
  READ_v_UNUSED(dbh_sConf_U2D1)
  READ_v_UNUSED(dbh_sConf_U2D2)
  Init_Jacobian(Jpsi_D0)
  Init_Jacobian(Jpsi_D1)
  Init_Jacobian(Jpsi_D2)
  READ_v_UNUSED(ChrisConf_U0D0D0)
  READ_v_UNUSED(ChrisConf_U0D0D1)
  READ_v_UNUSED(ChrisConf_U0D0D2)
  READ_v_UNUSED(ChrisConf_U0D1D1)
  READ_v_UNUSED(ChrisConf_U0D1D2)
  READ_v_UNUSED(ChrisConf_U0D2D2)
  READ_v_UNUSED(ChrisConf_U1D0D0)
  READ_v_UNUSED(ChrisConf_U1D0D1)
  READ_v_UNUSED(ChrisConf_U1D0D2)
  READ_v_UNUSED(ChrisConf_U1D1D1)
  READ_v_UNUSED(ChrisConf_U1D1D2)
  READ_v_UNUSED(ChrisConf_U1D2D2)
  READ_v_UNUSED(ChrisConf_U2D0D0)
  READ_v_UNUSED(ChrisConf_U2D0D1)
  READ_v_UNUSED(ChrisConf_U2D0D2)
  READ_v_UNUSED(ChrisConf_U2D1D1)
  READ_v_UNUSED(ChrisConf_U2D1D2)
  READ_v_UNUSED(ChrisConf_U2D2D2)
  if (patch->outerB)
  {
  DDM_SCHUR_JACOBIAN_BC_Bpart_OPEN

  double outerB_Bpart =
kd[ijk==lmn];

  B[schur_r][schur_c] = outerB_Bpart;

  DDM_SCHUR_JACOBIAN_BC_Bpart_CLOSE

  DDM_SCHUR_JACOBIAN_BC_Epart_OPEN

  double outerB_Epart =
0;

  E_Trans[schur_c][schur_r] = outerB_Epart;

  DDM_SCHUR_JACOBIAN_BC_Epart_CLOSE
  }/* end of if (patch->outerB) */
  else if (patch->innerB)
  {
  DDM_SCHUR_JACOBIAN_BC_Bpart_OPEN

  double Jpsi_D0 = d2f_dxdu_Jacobian(patch,0,ijk,lmn,Jpsi_D0);
  double Jpsi_D1 = d2f_dxdu_Jacobian(patch,1,ijk,lmn,Jpsi_D1);
  double Jpsi_D2 = d2f_dxdu_Jacobian(patch,2,ijk,lmn,Jpsi_D2);
  double _DiHSi_b =
ChrisConf_U0D0D0[ijk]*bh_sConf_U0[ijk] + ChrisConf_U0D0D1[ijk]*
bh_sConf_U1[ijk] + ChrisConf_U0D0D2[ijk]*bh_sConf_U2[ijk] +
ChrisConf_U1D0D1[ijk]*bh_sConf_U0[ijk] + ChrisConf_U1D1D1[ijk]*
bh_sConf_U1[ijk] + ChrisConf_U1D1D2[ijk]*bh_sConf_U2[ijk] +
ChrisConf_U2D0D2[ijk]*bh_sConf_U0[ijk] + ChrisConf_U2D1D2[ijk]*
bh_sConf_U1[ijk] + ChrisConf_U2D2D2[ijk]*bh_sConf_U2[ijk] +
dbh_sConf_U0D0[ijk] + dbh_sConf_U1D1[ijk] + dbh_sConf_U2D2[ijk];

  double psi2 =
pow(psi[ijk], 2);

  double psi3 =
pow(psi[ijk], 3);

  double innerB_Bpart =
3.0*kd[ijk==lmn]*psi2*(bh_sConf_U0[ijk]*dpsi_D0[ijk] + bh_sConf_U1[ijk]*
dpsi_D1[ijk] + bh_sConf_U2[ijk]*dpsi_D2[ijk]) + kd[ijk==lmn]*psi3*
(_DiHSi_b - psi2*trK[ijk]) + psi3*(Jpsi_D0*bh_sConf_U0[ijk] + Jpsi_D1*
bh_sConf_U1[ijk] + Jpsi_D2*bh_sConf_U2[ijk]);

  B[schur_r][schur_c] = innerB_Bpart;

  DDM_SCHUR_JACOBIAN_BC_Bpart_CLOSE

  DDM_SCHUR_JACOBIAN_BC_Epart_OPEN

  double Jpsi_D0 = d2f_dxdu_Jacobian(patch,0,ijk,lmn,Jpsi_D0);
  double Jpsi_D1 = d2f_dxdu_Jacobian(patch,1,ijk,lmn,Jpsi_D1);
  double Jpsi_D2 = d2f_dxdu_Jacobian(patch,2,ijk,lmn,Jpsi_D2);
  double _DiHSi_e =
ChrisConf_U0D0D0[ijk]*bh_sConf_U0[ijk] + ChrisConf_U0D0D1[ijk]*
bh_sConf_U1[ijk] + ChrisConf_U0D0D2[ijk]*bh_sConf_U2[ijk] +
ChrisConf_U1D0D1[ijk]*bh_sConf_U0[ijk] + ChrisConf_U1D1D1[ijk]*
bh_sConf_U1[ijk] + ChrisConf_U1D1D2[ijk]*bh_sConf_U2[ijk] +
ChrisConf_U2D0D2[ijk]*bh_sConf_U0[ijk] + ChrisConf_U2D1D2[ijk]*
bh_sConf_U1[ijk] + ChrisConf_U2D2D2[ijk]*bh_sConf_U2[ijk] +
dbh_sConf_U0D0[ijk] + dbh_sConf_U1D1[ijk] + dbh_sConf_U2D2[ijk];

  double psi2_ =
pow(psi[ijk], 2);

  double psi3_ =
pow(psi[ijk], 3);

  double innerB_Epart =
3.0*kd[ijk==lmn]*psi2_*(bh_sConf_U0[ijk]*dpsi_D0[ijk] +
bh_sConf_U1[ijk]*dpsi_D1[ijk] + bh_sConf_U2[ijk]*dpsi_D2[ijk]) +
kd[ijk==lmn]*psi3_*(_DiHSi_e - psi2_*trK[ijk]) + psi3_*(Jpsi_D0*
bh_sConf_U0[ijk] + Jpsi_D1*bh_sConf_U1[ijk] + Jpsi_D2*
bh_sConf_U2[ijk]);

  E_Trans[schur_c][schur_r] = innerB_Epart;

  DDM_SCHUR_JACOBIAN_BC_Epart_CLOSE

  }/* end of else if (patch->innerB) */


  Free_Jacobian(Jpsi_D0)
  Free_Jacobian(Jpsi_D1)
  Free_Jacobian(Jpsi_D2)

  Footer_Jacobian

  return 0;
}
