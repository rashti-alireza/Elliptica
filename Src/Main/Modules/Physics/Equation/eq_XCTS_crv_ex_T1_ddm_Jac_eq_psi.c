/*
  These C codes generated by Cpi version 3.0
  Copyright (C) 2019-2021 Alireza Rashti.
*/


#include "eq_header.h"
#include "maths_equation_solvings_lib.h"

void *eq_XCTS_curve_exc_T1_ddm_jacobian_eq_psi(void *vp1,void *vp2);
void *eq_XCTS_curve_exc_T1_ddm_jacobian_eq_psi(void *vp1,void *vp2)
{
  DDM_SCHUR_JACOBIAN_EQ_DECLARE
  Uint ijk,lmn;/* for Jacobian entries J[ijk][lmn] */
  const double kd[2] = {0.,1.};/* Kronecker delta */
  READ_v(psi)
  READ_v(trRicciConf)
  READ_v(trK)
  READ_v(AConfIJ2)
  READ_v(EConf)
  READ_v(igConf_U0U0)
  READ_v(igConf_U0U1)
  READ_v(igConf_U0U2)
  READ_v(igConf_U1U1)
  READ_v(igConf_U1U2)
  READ_v(igConf_U2U2)
  READ_v(ChrisConf_U0D0D0)
  READ_v(ChrisConf_U0D0D1)
  READ_v(ChrisConf_U0D0D2)
  READ_v(ChrisConf_U0D1D1)
  READ_v(ChrisConf_U0D1D2)
  READ_v(ChrisConf_U0D2D2)
  READ_v(ChrisConf_U1D0D0)
  READ_v(ChrisConf_U1D0D1)
  READ_v(ChrisConf_U1D0D2)
  READ_v(ChrisConf_U1D1D1)
  READ_v(ChrisConf_U1D1D2)
  READ_v(ChrisConf_U1D2D2)
  READ_v(ChrisConf_U2D0D0)
  READ_v(ChrisConf_U2D0D1)
  READ_v(ChrisConf_U2D0D2)
  READ_v(ChrisConf_U2D1D1)
  READ_v(ChrisConf_U2D1D2)
  READ_v(ChrisConf_U2D2D2)
  Init_Jacobian(Jpsi_D0)
  Init_Jacobian(Jpsi_D1)
  Init_Jacobian(Jpsi_D2)
  Init_Jacobian(JJpsi_D0D0)
  Init_Jacobian(JJpsi_D0D1)
  Init_Jacobian(JJpsi_D0D2)
  Init_Jacobian(JJpsi_D1D1)
  Init_Jacobian(JJpsi_D1D2)
  Init_Jacobian(JJpsi_D2D2)
  DDM_SCHUR_JACOBIAN_EQ_Bpart_OPEN

  double Jpsi_D0 = d2f_dxdu_Jacobian(patch,0,ijk,lmn,Jpsi_D0);
  double Jpsi_D1 = d2f_dxdu_Jacobian(patch,1,ijk,lmn,Jpsi_D1);
  double Jpsi_D2 = d2f_dxdu_Jacobian(patch,2,ijk,lmn,Jpsi_D2);
  double JJpsi_D0D0 = d3f_dx2du_Jacobian(patch,0,ijk,lmn,JJpsi_D0D0);
  double JJpsi_D0D1 = d3f_dx2du_Jacobian(patch,1,ijk,lmn,JJpsi_D0D1);
  double JJpsi_D0D2 = d3f_dx2du_Jacobian(patch,2,ijk,lmn,JJpsi_D0D2);
  double JJpsi_D1D1 = d3f_dx2du_Jacobian(patch,3,ijk,lmn,JJpsi_D1D1);
  double JJpsi_D1D2 = d3f_dx2du_Jacobian(patch,4,ijk,lmn,JJpsi_D1D2);
  double JJpsi_D2D2 = d3f_dx2du_Jacobian(patch,5,ijk,lmn,JJpsi_D2D2);
  double psi4_B =
pow(psi[ijk], 4);

  double aij2_B =
AConfIJ2[ijk]/psi4_B;

  double Bpart =
-ChrisConf_U0D0D0[ijk]*Jpsi_D0*igConf_U0U0[ijk] - 2.0*
ChrisConf_U0D0D1[ijk]*Jpsi_D0*igConf_U0U1[ijk] - 2.0*
ChrisConf_U0D0D2[ijk]*Jpsi_D0*igConf_U0U2[ijk] - ChrisConf_U0D1D1[ijk]*
Jpsi_D0*igConf_U1U1[ijk] - 2.0*ChrisConf_U0D1D2[ijk]*Jpsi_D0*
igConf_U1U2[ijk] - ChrisConf_U0D2D2[ijk]*Jpsi_D0*igConf_U2U2[ijk] -
ChrisConf_U1D0D0[ijk]*Jpsi_D1*igConf_U0U0[ijk] - 2.0*
ChrisConf_U1D0D1[ijk]*Jpsi_D1*igConf_U0U1[ijk] - 2.0*
ChrisConf_U1D0D2[ijk]*Jpsi_D1*igConf_U0U2[ijk] - ChrisConf_U1D1D1[ijk]*
Jpsi_D1*igConf_U1U1[ijk] - 2.0*ChrisConf_U1D1D2[ijk]*Jpsi_D1*
igConf_U1U2[ijk] - ChrisConf_U1D2D2[ijk]*Jpsi_D1*igConf_U2U2[ijk] -
ChrisConf_U2D0D0[ijk]*Jpsi_D2*igConf_U0U0[ijk] - 2.0*
ChrisConf_U2D0D1[ijk]*Jpsi_D2*igConf_U0U1[ijk] - 2.0*
ChrisConf_U2D0D2[ijk]*Jpsi_D2*igConf_U0U2[ijk] - ChrisConf_U2D1D1[ijk]*
Jpsi_D2*igConf_U1U1[ijk] - 2.0*ChrisConf_U2D1D2[ijk]*Jpsi_D2*
igConf_U1U2[ijk] - ChrisConf_U2D2D2[ijk]*Jpsi_D2*igConf_U2U2[ijk] +
JJpsi_D0D0*igConf_U0U0[ijk] + 2.0*JJpsi_D0D1*igConf_U0U1[ijk] + 2.0*
JJpsi_D0D2*igConf_U0U2[ijk] + JJpsi_D1D1*igConf_U1U1[ijk] + 2.0*
JJpsi_D1D2*igConf_U1U2[ijk] + JJpsi_D2D2*igConf_U2U2[ijk] -
kd[ijk==lmn]*(2*M_PI*EConf[ijk]/pow(psi[ijk], 2) + 0.875*aij2_B/psi4_B +
(5.0/12.0)*psi4_B*pow(trK[ijk], 2) + (1.0/8.0)*trRicciConf[ijk]);

  B[i][j] = Bpart;

  DDM_SCHUR_JACOBIAN_EQ_Bpart_CLOSE

  DDM_SCHUR_JACOBIAN_EQ_Epart_OPEN

  double Jpsi_D0 = d2f_dxdu_Jacobian(patch,0,ijk,lmn,Jpsi_D0);
  double Jpsi_D1 = d2f_dxdu_Jacobian(patch,1,ijk,lmn,Jpsi_D1);
  double Jpsi_D2 = d2f_dxdu_Jacobian(patch,2,ijk,lmn,Jpsi_D2);
  double JJpsi_D0D0 = d3f_dx2du_Jacobian(patch,0,ijk,lmn,JJpsi_D0D0);
  double JJpsi_D0D1 = d3f_dx2du_Jacobian(patch,1,ijk,lmn,JJpsi_D0D1);
  double JJpsi_D0D2 = d3f_dx2du_Jacobian(patch,2,ijk,lmn,JJpsi_D0D2);
  double JJpsi_D1D1 = d3f_dx2du_Jacobian(patch,3,ijk,lmn,JJpsi_D1D1);
  double JJpsi_D1D2 = d3f_dx2du_Jacobian(patch,4,ijk,lmn,JJpsi_D1D2);
  double JJpsi_D2D2 = d3f_dx2du_Jacobian(patch,5,ijk,lmn,JJpsi_D2D2);
  double psi4_E =
pow(psi[ijk], 4);

  double aij2_E =
AConfIJ2[ijk]/psi4_E;

  double Epart =
-ChrisConf_U0D0D0[ijk]*Jpsi_D0*igConf_U0U0[ijk] - 2.0*
ChrisConf_U0D0D1[ijk]*Jpsi_D0*igConf_U0U1[ijk] - 2.0*
ChrisConf_U0D0D2[ijk]*Jpsi_D0*igConf_U0U2[ijk] - ChrisConf_U0D1D1[ijk]*
Jpsi_D0*igConf_U1U1[ijk] - 2.0*ChrisConf_U0D1D2[ijk]*Jpsi_D0*
igConf_U1U2[ijk] - ChrisConf_U0D2D2[ijk]*Jpsi_D0*igConf_U2U2[ijk] -
ChrisConf_U1D0D0[ijk]*Jpsi_D1*igConf_U0U0[ijk] - 2.0*
ChrisConf_U1D0D1[ijk]*Jpsi_D1*igConf_U0U1[ijk] - 2.0*
ChrisConf_U1D0D2[ijk]*Jpsi_D1*igConf_U0U2[ijk] - ChrisConf_U1D1D1[ijk]*
Jpsi_D1*igConf_U1U1[ijk] - 2.0*ChrisConf_U1D1D2[ijk]*Jpsi_D1*
igConf_U1U2[ijk] - ChrisConf_U1D2D2[ijk]*Jpsi_D1*igConf_U2U2[ijk] -
ChrisConf_U2D0D0[ijk]*Jpsi_D2*igConf_U0U0[ijk] - 2.0*
ChrisConf_U2D0D1[ijk]*Jpsi_D2*igConf_U0U1[ijk] - 2.0*
ChrisConf_U2D0D2[ijk]*Jpsi_D2*igConf_U0U2[ijk] - ChrisConf_U2D1D1[ijk]*
Jpsi_D2*igConf_U1U1[ijk] - 2.0*ChrisConf_U2D1D2[ijk]*Jpsi_D2*
igConf_U1U2[ijk] - ChrisConf_U2D2D2[ijk]*Jpsi_D2*igConf_U2U2[ijk] +
JJpsi_D0D0*igConf_U0U0[ijk] + 2.0*JJpsi_D0D1*igConf_U0U1[ijk] + 2.0*
JJpsi_D0D2*igConf_U0U2[ijk] + JJpsi_D1D1*igConf_U1U1[ijk] + 2.0*
JJpsi_D1D2*igConf_U1U2[ijk] + JJpsi_D2D2*igConf_U2U2[ijk] -
kd[ijk==lmn]*(2*M_PI*EConf[ijk]/pow(psi[ijk], 2) + 0.875*aij2_E/psi4_E +
(5.0/12.0)*psi4_E*pow(trK[ijk], 2) + (1.0/8.0)*trRicciConf[ijk]);

  E_Trans[j][i] = Epart;

  DDM_SCHUR_JACOBIAN_EQ_Epart_CLOSE

  return 0;
}
