/*
  These C codes generated by Cpi version 3.0
  Copyright (C) 2019-2021 Alireza Rashti.
*/


#include "eq_header.h"
#include "maths_equation_solvings_lib.h"

void *eq_XCTS_curve_T3_ddm_jacobian_bc_phi(void *vp1,void *vp2);
void *eq_XCTS_curve_T3_ddm_jacobian_bc_phi(void *vp1,void *vp2)
{
  DDM_SCHUR_JACOBIAN_BC_DECLARE
  Uint ijk,lmn;/* for Jacobian entries J[ijk][lmn] */

  Header_Jacobian
  Init_Jacobian(Jphi_D0)
  Init_Jacobian(Jphi_D1)
  Init_Jacobian(Jphi_D2)
  READ_v(gConf_D0D0)
  READ_v(gConf_D0D1)
  READ_v(gConf_D0D2)
  READ_v(gConf_D1D1)
  READ_v(gConf_D1D2)
  READ_v(gConf_D2D2)
  if (patch->outerB)
  {
  DDM_SCHUR_JACOBIAN_BC_Bpart_OPEN

  double Jphi_D0 = d2f_dxdu_Jacobian(patch,0,ijk,lmn,Jphi_D0);
  double Jphi_D1 = d2f_dxdu_Jacobian(patch,1,ijk,lmn,Jphi_D1);
  double Jphi_D2 = d2f_dxdu_Jacobian(patch,2,ijk,lmn,Jphi_D2);
 double n_U0 = dq2_dq1(patch,_c_,_x_,ijk);
 double n_U1 = dq2_dq1(patch,_c_,_y_,ijk);
 double n_U2 = dq2_dq1(patch,_c_,_z_,ijk);
 double Norm_b =
gConf_D0D0[ijk]*pow(n_U0, 2) + 2.0*gConf_D0D1[ijk]*n_U0*n_U1 + 2.0*
gConf_D0D2[ijk]*n_U0*n_U2 + gConf_D1D1[ijk]*pow(n_U1, 2) + 2.0*
gConf_D1D2[ijk]*n_U1*n_U2 + gConf_D2D2[ijk]*pow(n_U2, 2);

 double s_b_U0 =
pow(Norm_b, -0.5)*n_U0;

 double s_b_U1 =
pow(Norm_b, -0.5)*n_U1;

 double s_b_U2 =
pow(Norm_b, -0.5)*n_U2;

 double outerB_Bpart =
Jphi_D0*gConf_D0D0[ijk]*s_b_U0 + Jphi_D0*gConf_D0D1[ijk]*s_b_U1 +
Jphi_D0*gConf_D0D2[ijk]*s_b_U2 + Jphi_D1*gConf_D0D1[ijk]*s_b_U0 +
Jphi_D1*gConf_D1D1[ijk]*s_b_U1 + Jphi_D1*gConf_D1D2[ijk]*s_b_U2 +
Jphi_D2*gConf_D0D2[ijk]*s_b_U0 + Jphi_D2*gConf_D1D2[ijk]*s_b_U1 +
Jphi_D2*gConf_D2D2[ijk]*s_b_U2;

  B[i][j] = outerB_Bpart;

  DDM_SCHUR_JACOBIAN_BC_Bpart_CLOSE

  DDM_SCHUR_JACOBIAN_BC_Epart_OPEN

  double Jphi_D0 = d2f_dxdu_Jacobian(patch,0,ijk,lmn,Jphi_D0);
  double Jphi_D1 = d2f_dxdu_Jacobian(patch,1,ijk,lmn,Jphi_D1);
  double Jphi_D2 = d2f_dxdu_Jacobian(patch,2,ijk,lmn,Jphi_D2);
 double n_U0 = dq2_dq1(patch,_c_,_x_,ijk);
 double n_U1 = dq2_dq1(patch,_c_,_y_,ijk);
 double n_U2 = dq2_dq1(patch,_c_,_z_,ijk);
 double Norm_e =
gConf_D0D0[ijk]*pow(n_U0, 2) + 2.0*gConf_D0D1[ijk]*n_U0*n_U1 + 2.0*
gConf_D0D2[ijk]*n_U0*n_U2 + gConf_D1D1[ijk]*pow(n_U1, 2) + 2.0*
gConf_D1D2[ijk]*n_U1*n_U2 + gConf_D2D2[ijk]*pow(n_U2, 2);

 double s_e_U0 =
pow(Norm_e, -0.5)*n_U0;

 double s_e_U1 =
pow(Norm_e, -0.5)*n_U1;

 double s_e_U2 =
pow(Norm_e, -0.5)*n_U2;

 double outerB_Epart =
Jphi_D0*gConf_D0D0[ijk]*s_e_U0 + Jphi_D0*gConf_D0D1[ijk]*s_e_U1 +
Jphi_D0*gConf_D0D2[ijk]*s_e_U2 + Jphi_D1*gConf_D0D1[ijk]*s_e_U0 +
Jphi_D1*gConf_D1D1[ijk]*s_e_U1 + Jphi_D1*gConf_D1D2[ijk]*s_e_U2 +
Jphi_D2*gConf_D0D2[ijk]*s_e_U0 + Jphi_D2*gConf_D1D2[ijk]*s_e_U1 +
Jphi_D2*gConf_D2D2[ijk]*s_e_U2;

  E_Trans[j][i] = outerB_Epart;

  DDM_SCHUR_JACOBIAN_BC_Epart_CLOSE
  }/* end of if (patch->outerB) */
  else if (patch->innerB)
  {
  DDM_SCHUR_JACOBIAN_BC_Bpart_OPEN

  double innerB_Bpart =
0;

  B[i][j] = innerB_Bpart;

  DDM_SCHUR_JACOBIAN_BC_Bpart_CLOSE

  DDM_SCHUR_JACOBIAN_BC_Epart_OPEN

  double innerB_Epart =
0;

  E_Trans[j][i] = innerB_Epart;

  DDM_SCHUR_JACOBIAN_BC_Epart_CLOSE

  }/* end of else if (patch->innerB) */


  Free_Jacobian(Jphi_D0)
  Free_Jacobian(Jphi_D1)
  Free_Jacobian(Jphi_D2)
  Footer_Jacobian

  return 0;
}
