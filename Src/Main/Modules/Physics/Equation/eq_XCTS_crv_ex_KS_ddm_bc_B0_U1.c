/*
  These C codes generated by Cpi version 2.0
  Copyright (C) 2019-2021 Alireza Rashti.
*/


#include "eq_header.h"
#include "maths_equation_solvings_lib.h"

void *eq_XCTS_curve_exc_KS_ddm_bc_B0_U1(void *vp1,void *vp2);
void *eq_XCTS_curve_exc_KS_ddm_bc_B0_U1(void *vp1,void *vp2)
{
  DDM_SCHUR_BC_DECLARE
  Uint ijk;/* node index */

  /* declaring: */
  READ_v(B0_U1)
  READ_v(B1_U1)
  READ_v(psi)
  READ_v(alphaPsi)
  READ_v(bh_sConf_U1)


  if (patch->outerB)/* at outer boundary */
  {
  EQ_Def_Param_Prefix_Char
  EQ_Set_Prefix("system")

  const double v1_boost = Pgetd(EQ_PrefixIt("boost_y"));
  DDM_SCHUR_BC_OPEN

  double outerB_F = 
B0_U1[ijk] - v1_boost;

  F[map[ijk]] = outerB_F;

  DDM_SCHUR_BC_CLOSE
  }/* end of if (patch->outerB) */
  else if (patch->innerB)/* at inner boundary */
  {
  EQ_Def_Param_Prefix_Char
  EQ_Set_Prefix("BH")

  const double BH_center_x = Pgetd(EQ_PrefixIt("center_x"));
  const double BH_center_z = Pgetd(EQ_PrefixIt("center_z"));
  const double BH_Omega_U0 = Pgetd(EQ_PrefixIt("Omega_U0"));
  const double BH_Omega_U2 = Pgetd(EQ_PrefixIt("Omega_U2"));

  DDM_SCHUR_BC_OPEN

  double alpha = 
alphaPsi[ijk]/psi[ijk];

  double S_U1 = 
bh_sConf_U1[ijk]/pow(psi[ijk], 2);

  double x = patch->node[ijk]->x[0]-BH_center_x;
  double z = patch->node[ijk]->x[2]-BH_center_z;
  double OmegaXr_U1 = 
-BH_Omega_U0*z + BH_Omega_U2*x;

  double innerB_F = 
B0_U1[ijk] + B1_U1[ijk] - OmegaXr_U1 - S_U1*alpha;

  F[map[ijk]] = innerB_F;

  DDM_SCHUR_BC_CLOSE
  }/* end of else if (patch->innerB) */
  return 0;
}
