/*
  These C codes generated by Cpi version 2.0
  Copyright (C) 2019-2021 Alireza Rashti.
*/


#include "eq_header.h"
#include "maths_equation_solvings_lib.h"

void *eq_XCTS_curve_exc_T2_ddm_jacobian_bc_alphaPsi(void *vp1,void *vp2);
void *eq_XCTS_curve_exc_T2_ddm_jacobian_bc_alphaPsi(void *vp1,void *vp2)
{
  DDM_SCHUR_JACOBIAN_BC_DECLARE
  Uint ijk,lmn;/* for Jacobian entries J[ijk][lmn] */
  const double kd[2] = {0.,1.};/* Kronecker delta */

  /* declaring: */
  JACOBIAN_DERIVATIVE(JalphaPsi_D1)
  JACOBIAN_DERIVATIVE(JalphaPsi_D0)
  JACOBIAN_DERIVATIVE(JalphaPsi_D2)
  READ_v(psi)
  READ_v(dpsi_D0)
  READ_v(dpsi_D1)
  READ_v(dpsi_D2)


  if (patch->outerB)
  {
  DDM_SCHUR_JACOBIAN_BC_Bpart_OPEN

  double outerB_Bpart = 
kd[ijk==lmn];

  B[i][j] = outerB_Bpart;

  DDM_SCHUR_JACOBIAN_BC_Bpart_CLOSE

  DDM_SCHUR_JACOBIAN_BC_Epart_OPEN

  double outerB_Epart = 
0;

  E_Trans[j][i] = outerB_Epart;

  DDM_SCHUR_JACOBIAN_BC_Epart_CLOSE
  }/* end of if (patch->outerB) */
  else if (patch->innerB)
  {
  EQ_Def_Param_Prefix_Char
  EQ_Set_Prefix("BH")
  const double BH_center[3] = {Pgetd(EQ_PrefixIt("center_x")),
                               Pgetd(EQ_PrefixIt("center_y")),
                               Pgetd(EQ_PrefixIt("center_z"))};

  DDM_SCHUR_JACOBIAN_BC_Bpart_OPEN

 double x_U0 = patch->node[ijk]->x[0] - BH_center[0];
 double x_U1 = patch->node[ijk]->x[1] - BH_center[1];
 double x_U2 = patch->node[ijk]->x[2] - BH_center[2];
 double innerB_Bpart = 
x_U0*(JalphaPsi_D0(j_JalphaPsi_D0,ijk,lmn)*psi[ijk] - dpsi_D0[ijk]*
kd[ijk==lmn]) + x_U1*(JalphaPsi_D1(j_JalphaPsi_D1,ijk,lmn)*psi[ijk] -
dpsi_D1[ijk]*kd[ijk==lmn]) + x_U2*(JalphaPsi_D2(j_JalphaPsi_D2,ijk,lmn)*
psi[ijk] - dpsi_D2[ijk]*kd[ijk==lmn]);

  B[i][j] = innerB_Bpart;

  DDM_SCHUR_JACOBIAN_BC_Bpart_CLOSE

  DDM_SCHUR_JACOBIAN_BC_Epart_OPEN

 double x_U0 = patch->node[ijk]->x[0] - BH_center[0];
 double x_U1 = patch->node[ijk]->x[1] - BH_center[1];
 double x_U2 = patch->node[ijk]->x[2] - BH_center[2];
 double innerB_Epart = 
x_U0*(JalphaPsi_D0(j_JalphaPsi_D0,ijk,lmn)*psi[ijk] - dpsi_D0[ijk]*
kd[ijk==lmn]) + x_U1*(JalphaPsi_D1(j_JalphaPsi_D1,ijk,lmn)*psi[ijk] -
dpsi_D1[ijk]*kd[ijk==lmn]) + x_U2*(JalphaPsi_D2(j_JalphaPsi_D2,ijk,lmn)*
psi[ijk] - dpsi_D2[ijk]*kd[ijk==lmn]);

  E_Trans[j][i] = innerB_Epart;

  DDM_SCHUR_JACOBIAN_BC_Epart_CLOSE

  }/* end of else if (patch->innerB) */

  return 0;
}
