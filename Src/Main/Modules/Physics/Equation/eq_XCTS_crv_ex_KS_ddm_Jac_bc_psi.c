/*
  These C codes generated by Cpi version 2.0
  Copyright (C) 2019-2021 Alireza Rashti.
*/


#include "eq_header.h"
#include "maths_equation_solvings_lib.h"

void *eq_XCTS_curve_exc_KS_ddm_jacobian_bc_psi(void *vp1,void *vp2);
void *eq_XCTS_curve_exc_KS_ddm_jacobian_bc_psi(void *vp1,void *vp2)
{
  DDM_SCHUR_JACOBIAN_BC_DECLARE
  Uint ijk,lmn;/* for Jacobian entries J[ijk][lmn] */
  const double kd[2] = {0.,1.};/* Kronecker delta */
  const double is_Aij_on = 1.;


  /* declaring: */
  READ_v(psi)
  READ_v(trK)
  READ_v_UNUSED(AConfIJ_U0U1)
  READ_v_UNUSED(AConfIJ_U0U0)
  READ_v_UNUSED(AConfIJ_U0U2)
  READ_v_UNUSED(AConfIJ_U2U2)
  READ_v_UNUSED(AConfIJ_U1U1)
  READ_v_UNUSED(AConfIJ_U1U2)
  READ_v_UNUSED(gConf_D0D2)
  READ_v_UNUSED(gConf_D0D0)
  READ_v_UNUSED(gConf_D0D1)
  READ_v_UNUSED(gConf_D1D2)
  READ_v_UNUSED(gConf_D1D1)
  READ_v_UNUSED(gConf_D2D2)
  READ_v(bh_sConf_U1)
  READ_v(bh_sConf_U0)
  READ_v(bh_sConf_U2)
  READ_v_UNUSED(dbh_sConf_U2D2)
  READ_v_UNUSED(dbh_sConf_U2D0)
  READ_v_UNUSED(dbh_sConf_U2D1)
  READ_v_UNUSED(dbh_sConf_U0D0)
  READ_v_UNUSED(dbh_sConf_U0D1)
  READ_v_UNUSED(dbh_sConf_U0D2)
  READ_v_UNUSED(dbh_sConf_U1D2)
  READ_v_UNUSED(dbh_sConf_U1D1)
  READ_v_UNUSED(dbh_sConf_U1D0)
  JACOBIAN_DERIVATIVE(Jpsi_D2)
  JACOBIAN_DERIVATIVE(Jpsi_D0)
  JACOBIAN_DERIVATIVE(Jpsi_D1)
  READ_v_UNUSED(ChrisConf_U1D0D0)
  READ_v_UNUSED(ChrisConf_U0D2D2)
  READ_v_UNUSED(ChrisConf_U1D0D2)
  READ_v_UNUSED(ChrisConf_U2D2D2)
  READ_v_UNUSED(ChrisConf_U2D1D1)
  READ_v_UNUSED(ChrisConf_U2D0D0)
  READ_v_UNUSED(ChrisConf_U1D1D1)
  READ_v_UNUSED(ChrisConf_U0D1D1)
  READ_v_UNUSED(ChrisConf_U0D1D2)
  READ_v_UNUSED(ChrisConf_U1D1D2)
  READ_v_UNUSED(ChrisConf_U0D0D1)
  READ_v_UNUSED(ChrisConf_U0D0D0)
  READ_v_UNUSED(ChrisConf_U2D0D1)
  READ_v_UNUSED(ChrisConf_U0D0D2)
  READ_v_UNUSED(ChrisConf_U2D1D2)
  READ_v_UNUSED(ChrisConf_U1D2D2)
  READ_v_UNUSED(ChrisConf_U2D0D2)
  READ_v_UNUSED(ChrisConf_U1D0D1)


  if (patch->outerB)
  {
  DDM_SCHUR_JACOBIAN_BC_Bpart_OPEN

  double outerB_Bpart = 
kd[ijk==lmn];

  B[i][j] = outerB_Bpart;

  DDM_SCHUR_JACOBIAN_BC_Bpart_CLOSE

  DDM_SCHUR_JACOBIAN_BC_Epart_OPEN

  double outerB_Epart = 
0;

  E_Trans[j][i] = outerB_Epart;

  DDM_SCHUR_JACOBIAN_BC_Epart_CLOSE
  }/* end of if (patch->outerB) */
  else if (patch->innerB)
  {
  DDM_SCHUR_JACOBIAN_BC_Bpart_OPEN

  double _DiHSi_b = 
ChrisConf_U0D0D0[ijk]*bh_sConf_U0[ijk] + ChrisConf_U0D0D1[ijk]*
bh_sConf_U1[ijk] + ChrisConf_U0D0D2[ijk]*bh_sConf_U2[ijk] +
ChrisConf_U1D0D1[ijk]*bh_sConf_U0[ijk] + ChrisConf_U1D1D1[ijk]*
bh_sConf_U1[ijk] + ChrisConf_U1D1D2[ijk]*bh_sConf_U2[ijk] +
ChrisConf_U2D0D2[ijk]*bh_sConf_U0[ijk] + ChrisConf_U2D1D2[ijk]*
bh_sConf_U1[ijk] + ChrisConf_U2D2D2[ijk]*bh_sConf_U2[ijk] +
dbh_sConf_U0D0[ijk] + dbh_sConf_U1D1[ijk] + dbh_sConf_U2D2[ijk];

  double B_t1 = 
(0.75*AConfIJ_U0U0[ijk]*pow(bh_sConf_U0[ijk], 2)*pow(gConf_D0D0[ijk], 2) +
1.5*AConfIJ_U0U0[ijk]*bh_sConf_U0[ijk]*bh_sConf_U1[ijk]*gConf_D0D0[ijk]*
gConf_D0D1[ijk] + 1.5*AConfIJ_U0U0[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U2[ijk]*gConf_D0D0[ijk]*gConf_D0D2[ijk] + 0.75*
AConfIJ_U0U0[ijk]*pow(bh_sConf_U1[ijk], 2)*pow(gConf_D0D1[ijk], 2) +
1.5*AConfIJ_U0U0[ijk]*bh_sConf_U1[ijk]*bh_sConf_U2[ijk]*gConf_D0D1[ijk]*
gConf_D0D2[ijk] + 0.75*AConfIJ_U0U0[ijk]*pow(bh_sConf_U2[ijk], 2)*
pow(gConf_D0D2[ijk], 2) + 1.5*AConfIJ_U0U1[ijk]*pow(bh_sConf_U0[ijk], 2)*
gConf_D0D0[ijk]*gConf_D0D1[ijk] + 1.5*AConfIJ_U0U1[ijk]*
bh_sConf_U0[ijk]*bh_sConf_U1[ijk]*gConf_D0D0[ijk]*gConf_D1D1[ijk] + 1.5*
AConfIJ_U0U1[ijk]*bh_sConf_U0[ijk]*bh_sConf_U1[ijk]*
pow(gConf_D0D1[ijk], 2) + 1.5*AConfIJ_U0U1[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U2[ijk]*gConf_D0D0[ijk]*gConf_D1D2[ijk] + 1.5*
AConfIJ_U0U1[ijk]*bh_sConf_U0[ijk]*bh_sConf_U2[ijk]*gConf_D0D1[ijk]*
gConf_D0D2[ijk] + 1.5*AConfIJ_U0U1[ijk]*pow(bh_sConf_U1[ijk], 2)*
gConf_D0D1[ijk]*gConf_D1D1[ijk] + 1.5*AConfIJ_U0U1[ijk]*
bh_sConf_U1[ijk]*bh_sConf_U2[ijk]*gConf_D0D1[ijk]*gConf_D1D2[ijk] + 1.5*
AConfIJ_U0U1[ijk]*bh_sConf_U1[ijk]*bh_sConf_U2[ijk]*gConf_D0D2[ijk]*
gConf_D1D1[ijk] + 1.5*AConfIJ_U0U1[ijk]*pow(bh_sConf_U2[ijk], 2)*
gConf_D0D2[ijk]*gConf_D1D2[ijk] + 1.5*AConfIJ_U0U2[ijk]*
pow(bh_sConf_U0[ijk], 2)*gConf_D0D0[ijk]*gConf_D0D2[ijk] + 1.5*
AConfIJ_U0U2[ijk]*bh_sConf_U0[ijk]*bh_sConf_U1[ijk]*gConf_D0D0[ijk]*
gConf_D1D2[ijk] + 1.5*AConfIJ_U0U2[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U1[ijk]*gConf_D0D1[ijk]*gConf_D0D2[ijk] + 1.5*
AConfIJ_U0U2[ijk]*bh_sConf_U0[ijk]*bh_sConf_U2[ijk]*gConf_D0D0[ijk]*
gConf_D2D2[ijk] + 1.5*AConfIJ_U0U2[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U2[ijk]*pow(gConf_D0D2[ijk], 2) + 1.5*AConfIJ_U0U2[ijk]*
pow(bh_sConf_U1[ijk], 2)*gConf_D0D1[ijk]*gConf_D1D2[ijk] + 1.5*
AConfIJ_U0U2[ijk]*bh_sConf_U1[ijk]*bh_sConf_U2[ijk]*gConf_D0D1[ijk]*
gConf_D2D2[ijk] + 1.5*AConfIJ_U0U2[ijk]*bh_sConf_U1[ijk]*
bh_sConf_U2[ijk]*gConf_D0D2[ijk]*gConf_D1D2[ijk] + 1.5*
AConfIJ_U0U2[ijk]*pow(bh_sConf_U2[ijk], 2)*gConf_D0D2[ijk]*
gConf_D2D2[ijk] + 0.75*AConfIJ_U1U1[ijk]*pow(bh_sConf_U0[ijk], 2)*
pow(gConf_D0D1[ijk], 2) + 1.5*AConfIJ_U1U1[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U1[ijk]*gConf_D0D1[ijk]*gConf_D1D1[ijk] + 1.5*
AConfIJ_U1U1[ijk]*bh_sConf_U0[ijk]*bh_sConf_U2[ijk]*gConf_D0D1[ijk]*
gConf_D1D2[ijk] + 0.75*AConfIJ_U1U1[ijk]*pow(bh_sConf_U1[ijk], 2)*
pow(gConf_D1D1[ijk], 2) + 1.5*AConfIJ_U1U1[ijk]*bh_sConf_U1[ijk]*
bh_sConf_U2[ijk]*gConf_D1D1[ijk]*gConf_D1D2[ijk] + 0.75*
AConfIJ_U1U1[ijk]*pow(bh_sConf_U2[ijk], 2)*pow(gConf_D1D2[ijk], 2) +
1.5*AConfIJ_U1U2[ijk]*pow(bh_sConf_U0[ijk], 2)*gConf_D0D1[ijk]*
gConf_D0D2[ijk] + 1.5*AConfIJ_U1U2[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U1[ijk]*gConf_D0D1[ijk]*gConf_D1D2[ijk] + 1.5*
AConfIJ_U1U2[ijk]*bh_sConf_U0[ijk]*bh_sConf_U1[ijk]*gConf_D0D2[ijk]*
gConf_D1D1[ijk] + 1.5*AConfIJ_U1U2[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U2[ijk]*gConf_D0D1[ijk]*gConf_D2D2[ijk] + 1.5*
AConfIJ_U1U2[ijk]*bh_sConf_U0[ijk]*bh_sConf_U2[ijk]*gConf_D0D2[ijk]*
gConf_D1D2[ijk] + 1.5*AConfIJ_U1U2[ijk]*pow(bh_sConf_U1[ijk], 2)*
gConf_D1D1[ijk]*gConf_D1D2[ijk] + 1.5*AConfIJ_U1U2[ijk]*
bh_sConf_U1[ijk]*bh_sConf_U2[ijk]*gConf_D1D1[ijk]*gConf_D2D2[ijk] + 1.5*
AConfIJ_U1U2[ijk]*bh_sConf_U1[ijk]*bh_sConf_U2[ijk]*
pow(gConf_D1D2[ijk], 2) + 1.5*AConfIJ_U1U2[ijk]*pow(bh_sConf_U2[ijk], 2)*
gConf_D1D2[ijk]*gConf_D2D2[ijk] + 0.75*AConfIJ_U2U2[ijk]*
pow(bh_sConf_U0[ijk], 2)*pow(gConf_D0D2[ijk], 2) + 1.5*
AConfIJ_U2U2[ijk]*bh_sConf_U0[ijk]*bh_sConf_U1[ijk]*gConf_D0D2[ijk]*
gConf_D1D2[ijk] + 1.5*AConfIJ_U2U2[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U2[ijk]*gConf_D0D2[ijk]*gConf_D2D2[ijk] + 0.75*
AConfIJ_U2U2[ijk]*pow(bh_sConf_U1[ijk], 2)*pow(gConf_D1D2[ijk], 2) +
1.5*AConfIJ_U2U2[ijk]*bh_sConf_U1[ijk]*bh_sConf_U2[ijk]*gConf_D1D2[ijk]*
gConf_D2D2[ijk] + 0.75*AConfIJ_U2U2[ijk]*pow(bh_sConf_U2[ijk], 2)*
pow(gConf_D2D2[ijk], 2))/pow(psi[ijk], 4);

  double innerB_Bpart = 
Jpsi_D0(j_Jpsi_D0,ijk,lmn)*bh_sConf_U0[ijk] + Jpsi_D1(j_Jpsi_D1,ijk,lmn)*
bh_sConf_U1[ijk] + Jpsi_D2(j_Jpsi_D2,ijk,lmn)*bh_sConf_U2[ijk] - 1.0/
4.0*kd[ijk==lmn]*(4*B_t1*is_Aij_on - _DiHSi_b + 2*pow(psi[ijk], 2)*
trK[ijk]);

  B[i][j] = innerB_Bpart;

  DDM_SCHUR_JACOBIAN_BC_Bpart_CLOSE

  DDM_SCHUR_JACOBIAN_BC_Epart_OPEN

  double _DiHSi_e = 
ChrisConf_U0D0D0[ijk]*bh_sConf_U0[ijk] + ChrisConf_U0D0D1[ijk]*
bh_sConf_U1[ijk] + ChrisConf_U0D0D2[ijk]*bh_sConf_U2[ijk] +
ChrisConf_U1D0D1[ijk]*bh_sConf_U0[ijk] + ChrisConf_U1D1D1[ijk]*
bh_sConf_U1[ijk] + ChrisConf_U1D1D2[ijk]*bh_sConf_U2[ijk] +
ChrisConf_U2D0D2[ijk]*bh_sConf_U0[ijk] + ChrisConf_U2D1D2[ijk]*
bh_sConf_U1[ijk] + ChrisConf_U2D2D2[ijk]*bh_sConf_U2[ijk] +
dbh_sConf_U0D0[ijk] + dbh_sConf_U1D1[ijk] + dbh_sConf_U2D2[ijk];

  double E_t1 = 
(0.75*AConfIJ_U0U0[ijk]*pow(bh_sConf_U0[ijk], 2)*pow(gConf_D0D0[ijk], 2) +
1.5*AConfIJ_U0U0[ijk]*bh_sConf_U0[ijk]*bh_sConf_U1[ijk]*gConf_D0D0[ijk]*
gConf_D0D1[ijk] + 1.5*AConfIJ_U0U0[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U2[ijk]*gConf_D0D0[ijk]*gConf_D0D2[ijk] + 0.75*
AConfIJ_U0U0[ijk]*pow(bh_sConf_U1[ijk], 2)*pow(gConf_D0D1[ijk], 2) +
1.5*AConfIJ_U0U0[ijk]*bh_sConf_U1[ijk]*bh_sConf_U2[ijk]*gConf_D0D1[ijk]*
gConf_D0D2[ijk] + 0.75*AConfIJ_U0U0[ijk]*pow(bh_sConf_U2[ijk], 2)*
pow(gConf_D0D2[ijk], 2) + 1.5*AConfIJ_U0U1[ijk]*pow(bh_sConf_U0[ijk], 2)*
gConf_D0D0[ijk]*gConf_D0D1[ijk] + 1.5*AConfIJ_U0U1[ijk]*
bh_sConf_U0[ijk]*bh_sConf_U1[ijk]*gConf_D0D0[ijk]*gConf_D1D1[ijk] + 1.5*
AConfIJ_U0U1[ijk]*bh_sConf_U0[ijk]*bh_sConf_U1[ijk]*
pow(gConf_D0D1[ijk], 2) + 1.5*AConfIJ_U0U1[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U2[ijk]*gConf_D0D0[ijk]*gConf_D1D2[ijk] + 1.5*
AConfIJ_U0U1[ijk]*bh_sConf_U0[ijk]*bh_sConf_U2[ijk]*gConf_D0D1[ijk]*
gConf_D0D2[ijk] + 1.5*AConfIJ_U0U1[ijk]*pow(bh_sConf_U1[ijk], 2)*
gConf_D0D1[ijk]*gConf_D1D1[ijk] + 1.5*AConfIJ_U0U1[ijk]*
bh_sConf_U1[ijk]*bh_sConf_U2[ijk]*gConf_D0D1[ijk]*gConf_D1D2[ijk] + 1.5*
AConfIJ_U0U1[ijk]*bh_sConf_U1[ijk]*bh_sConf_U2[ijk]*gConf_D0D2[ijk]*
gConf_D1D1[ijk] + 1.5*AConfIJ_U0U1[ijk]*pow(bh_sConf_U2[ijk], 2)*
gConf_D0D2[ijk]*gConf_D1D2[ijk] + 1.5*AConfIJ_U0U2[ijk]*
pow(bh_sConf_U0[ijk], 2)*gConf_D0D0[ijk]*gConf_D0D2[ijk] + 1.5*
AConfIJ_U0U2[ijk]*bh_sConf_U0[ijk]*bh_sConf_U1[ijk]*gConf_D0D0[ijk]*
gConf_D1D2[ijk] + 1.5*AConfIJ_U0U2[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U1[ijk]*gConf_D0D1[ijk]*gConf_D0D2[ijk] + 1.5*
AConfIJ_U0U2[ijk]*bh_sConf_U0[ijk]*bh_sConf_U2[ijk]*gConf_D0D0[ijk]*
gConf_D2D2[ijk] + 1.5*AConfIJ_U0U2[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U2[ijk]*pow(gConf_D0D2[ijk], 2) + 1.5*AConfIJ_U0U2[ijk]*
pow(bh_sConf_U1[ijk], 2)*gConf_D0D1[ijk]*gConf_D1D2[ijk] + 1.5*
AConfIJ_U0U2[ijk]*bh_sConf_U1[ijk]*bh_sConf_U2[ijk]*gConf_D0D1[ijk]*
gConf_D2D2[ijk] + 1.5*AConfIJ_U0U2[ijk]*bh_sConf_U1[ijk]*
bh_sConf_U2[ijk]*gConf_D0D2[ijk]*gConf_D1D2[ijk] + 1.5*
AConfIJ_U0U2[ijk]*pow(bh_sConf_U2[ijk], 2)*gConf_D0D2[ijk]*
gConf_D2D2[ijk] + 0.75*AConfIJ_U1U1[ijk]*pow(bh_sConf_U0[ijk], 2)*
pow(gConf_D0D1[ijk], 2) + 1.5*AConfIJ_U1U1[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U1[ijk]*gConf_D0D1[ijk]*gConf_D1D1[ijk] + 1.5*
AConfIJ_U1U1[ijk]*bh_sConf_U0[ijk]*bh_sConf_U2[ijk]*gConf_D0D1[ijk]*
gConf_D1D2[ijk] + 0.75*AConfIJ_U1U1[ijk]*pow(bh_sConf_U1[ijk], 2)*
pow(gConf_D1D1[ijk], 2) + 1.5*AConfIJ_U1U1[ijk]*bh_sConf_U1[ijk]*
bh_sConf_U2[ijk]*gConf_D1D1[ijk]*gConf_D1D2[ijk] + 0.75*
AConfIJ_U1U1[ijk]*pow(bh_sConf_U2[ijk], 2)*pow(gConf_D1D2[ijk], 2) +
1.5*AConfIJ_U1U2[ijk]*pow(bh_sConf_U0[ijk], 2)*gConf_D0D1[ijk]*
gConf_D0D2[ijk] + 1.5*AConfIJ_U1U2[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U1[ijk]*gConf_D0D1[ijk]*gConf_D1D2[ijk] + 1.5*
AConfIJ_U1U2[ijk]*bh_sConf_U0[ijk]*bh_sConf_U1[ijk]*gConf_D0D2[ijk]*
gConf_D1D1[ijk] + 1.5*AConfIJ_U1U2[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U2[ijk]*gConf_D0D1[ijk]*gConf_D2D2[ijk] + 1.5*
AConfIJ_U1U2[ijk]*bh_sConf_U0[ijk]*bh_sConf_U2[ijk]*gConf_D0D2[ijk]*
gConf_D1D2[ijk] + 1.5*AConfIJ_U1U2[ijk]*pow(bh_sConf_U1[ijk], 2)*
gConf_D1D1[ijk]*gConf_D1D2[ijk] + 1.5*AConfIJ_U1U2[ijk]*
bh_sConf_U1[ijk]*bh_sConf_U2[ijk]*gConf_D1D1[ijk]*gConf_D2D2[ijk] + 1.5*
AConfIJ_U1U2[ijk]*bh_sConf_U1[ijk]*bh_sConf_U2[ijk]*
pow(gConf_D1D2[ijk], 2) + 1.5*AConfIJ_U1U2[ijk]*pow(bh_sConf_U2[ijk], 2)*
gConf_D1D2[ijk]*gConf_D2D2[ijk] + 0.75*AConfIJ_U2U2[ijk]*
pow(bh_sConf_U0[ijk], 2)*pow(gConf_D0D2[ijk], 2) + 1.5*
AConfIJ_U2U2[ijk]*bh_sConf_U0[ijk]*bh_sConf_U1[ijk]*gConf_D0D2[ijk]*
gConf_D1D2[ijk] + 1.5*AConfIJ_U2U2[ijk]*bh_sConf_U0[ijk]*
bh_sConf_U2[ijk]*gConf_D0D2[ijk]*gConf_D2D2[ijk] + 0.75*
AConfIJ_U2U2[ijk]*pow(bh_sConf_U1[ijk], 2)*pow(gConf_D1D2[ijk], 2) +
1.5*AConfIJ_U2U2[ijk]*bh_sConf_U1[ijk]*bh_sConf_U2[ijk]*gConf_D1D2[ijk]*
gConf_D2D2[ijk] + 0.75*AConfIJ_U2U2[ijk]*pow(bh_sConf_U2[ijk], 2)*
pow(gConf_D2D2[ijk], 2))/pow(psi[ijk], 4);

  double innerB_Epart = 
Jpsi_D0(j_Jpsi_D0,ijk,lmn)*bh_sConf_U0[ijk] + Jpsi_D1(j_Jpsi_D1,ijk,lmn)*
bh_sConf_U1[ijk] + Jpsi_D2(j_Jpsi_D2,ijk,lmn)*bh_sConf_U2[ijk] - 1.0/
4.0*kd[ijk==lmn]*(4*E_t1*is_Aij_on - _DiHSi_e + 2*pow(psi[ijk], 2)*
trK[ijk]);

  E_Trans[j][i] = innerB_Epart;

  DDM_SCHUR_JACOBIAN_BC_Epart_CLOSE

  }/* end of else if (patch->innerB) */

  return 0;
}
