/*
  These C codes generated by Cpi version 2.0
  Copyright (C) 2019-2020 Alireza Rashti.
*/


#include "adm_header.h"
void adm_update_adm_Kij_useAIJ(Patch_T *const patch);
void adm_update_adm_Kij_useAIJ(Patch_T *const patch)
{

  /* declaring: */
  REALLOC_v_WRITE_v(adm_Kij_D2D2)
  REALLOC_v_WRITE_v(adm_Kij_D0D2)
  REALLOC_v_WRITE_v(adm_Kij_D1D2)
  REALLOC_v_WRITE_v(adm_Kij_D0D0)
  REALLOC_v_WRITE_v(adm_Kij_D0D1)
  REALLOC_v_WRITE_v(adm_Kij_D1D1)
  READ_v(AConfIJ_U0U1)
  READ_v(AConfIJ_U0U0)
  READ_v(AConfIJ_U0U2)
  READ_v(AConfIJ_U2U2)
  READ_v(AConfIJ_U1U1)
  READ_v(AConfIJ_U1U2)
  READ_v(psi)
  READ_v(trK)
  READ_v(gConf_D0D2)
  READ_v(gConf_D0D0)
  READ_v(gConf_D0D1)
  READ_v(gConf_D1D2)
  READ_v(gConf_D1D1)
  READ_v(gConf_D2D2)


FOR_ALL_ijk
{
  double psi2 = 
pow(psi[ijk], 2);

  double psim2 = 
1.0/psi2;

  double psi4 = 
pow(psi2, 2);

  double Kij_D2D2 = 
(1.0/3.0)*gConf_D2D2[ijk]*psi4*trK[ijk] + psim2*(AConfIJ_U0U0[ijk]*
pow(gConf_D0D2[ijk], 2) + 2.0*AConfIJ_U0U1[ijk]*gConf_D0D2[ijk]*
gConf_D1D2[ijk] + 2.0*AConfIJ_U0U2[ijk]*gConf_D0D2[ijk]*
gConf_D2D2[ijk] + AConfIJ_U1U1[ijk]*pow(gConf_D1D2[ijk], 2) + 2.0*
AConfIJ_U1U2[ijk]*gConf_D1D2[ijk]*gConf_D2D2[ijk] + AConfIJ_U2U2[ijk]*
pow(gConf_D2D2[ijk], 2));

  double Kij_D0D1 = 
(1.0/3.0)*gConf_D0D1[ijk]*psi4*trK[ijk] + psim2*(AConfIJ_U0U0[ijk]*
gConf_D0D0[ijk]*gConf_D0D1[ijk] + AConfIJ_U0U1[ijk]*gConf_D0D0[ijk]*
gConf_D1D1[ijk] + AConfIJ_U0U1[ijk]*pow(gConf_D0D1[ijk], 2) + 
AConfIJ_U0U2[ijk]*gConf_D0D0[ijk]*gConf_D1D2[ijk] + AConfIJ_U0U2[ijk]*
gConf_D0D1[ijk]*gConf_D0D2[ijk] + AConfIJ_U1U1[ijk]*gConf_D0D1[ijk]*
gConf_D1D1[ijk] + AConfIJ_U1U2[ijk]*gConf_D0D1[ijk]*gConf_D1D2[ijk] + 
AConfIJ_U1U2[ijk]*gConf_D0D2[ijk]*gConf_D1D1[ijk] + AConfIJ_U2U2[ijk]*
gConf_D0D2[ijk]*gConf_D1D2[ijk]);

  double Kij_D0D0 = 
(1.0/3.0)*gConf_D0D0[ijk]*psi4*trK[ijk] + psim2*(AConfIJ_U0U0[ijk]*
pow(gConf_D0D0[ijk], 2) + 2.0*AConfIJ_U0U1[ijk]*gConf_D0D0[ijk]*
gConf_D0D1[ijk] + 2.0*AConfIJ_U0U2[ijk]*gConf_D0D0[ijk]*
gConf_D0D2[ijk] + AConfIJ_U1U1[ijk]*pow(gConf_D0D1[ijk], 2) + 2.0*
AConfIJ_U1U2[ijk]*gConf_D0D1[ijk]*gConf_D0D2[ijk] + AConfIJ_U2U2[ijk]*
pow(gConf_D0D2[ijk], 2));

  double Kij_D0D2 = 
(1.0/3.0)*gConf_D0D2[ijk]*psi4*trK[ijk] + psim2*(AConfIJ_U0U0[ijk]*
gConf_D0D0[ijk]*gConf_D0D2[ijk] + AConfIJ_U0U1[ijk]*gConf_D0D0[ijk]*
gConf_D1D2[ijk] + AConfIJ_U0U1[ijk]*gConf_D0D1[ijk]*gConf_D0D2[ijk] + 
AConfIJ_U0U2[ijk]*gConf_D0D0[ijk]*gConf_D2D2[ijk] + AConfIJ_U0U2[ijk]*
pow(gConf_D0D2[ijk], 2) + AConfIJ_U1U1[ijk]*gConf_D0D1[ijk]*
gConf_D1D2[ijk] + AConfIJ_U1U2[ijk]*gConf_D0D1[ijk]*gConf_D2D2[ijk] + 
AConfIJ_U1U2[ijk]*gConf_D0D2[ijk]*gConf_D1D2[ijk] + AConfIJ_U2U2[ijk]*
gConf_D0D2[ijk]*gConf_D2D2[ijk]);

  double Kij_D1D1 = 
(1.0/3.0)*gConf_D1D1[ijk]*psi4*trK[ijk] + psim2*(AConfIJ_U0U0[ijk]*
pow(gConf_D0D1[ijk], 2) + 2.0*AConfIJ_U0U1[ijk]*gConf_D0D1[ijk]*
gConf_D1D1[ijk] + 2.0*AConfIJ_U0U2[ijk]*gConf_D0D1[ijk]*
gConf_D1D2[ijk] + AConfIJ_U1U1[ijk]*pow(gConf_D1D1[ijk], 2) + 2.0*
AConfIJ_U1U2[ijk]*gConf_D1D1[ijk]*gConf_D1D2[ijk] + AConfIJ_U2U2[ijk]*
pow(gConf_D1D2[ijk], 2));

  double Kij_D1D2 = 
(1.0/3.0)*gConf_D1D2[ijk]*psi4*trK[ijk] + psim2*(AConfIJ_U0U0[ijk]*
gConf_D0D1[ijk]*gConf_D0D2[ijk] + AConfIJ_U0U1[ijk]*gConf_D0D1[ijk]*
gConf_D1D2[ijk] + AConfIJ_U0U1[ijk]*gConf_D0D2[ijk]*gConf_D1D1[ijk] + 
AConfIJ_U0U2[ijk]*gConf_D0D1[ijk]*gConf_D2D2[ijk] + AConfIJ_U0U2[ijk]*
gConf_D0D2[ijk]*gConf_D1D2[ijk] + AConfIJ_U1U1[ijk]*gConf_D1D1[ijk]*
gConf_D1D2[ijk] + AConfIJ_U1U2[ijk]*gConf_D1D1[ijk]*gConf_D2D2[ijk] + 
AConfIJ_U1U2[ijk]*pow(gConf_D1D2[ijk], 2) + AConfIJ_U2U2[ijk]*
gConf_D1D2[ijk]*gConf_D2D2[ijk]);


  /* populating: */
  adm_Kij_D2D2[ijk] = Kij_D2D2;
  adm_Kij_D0D2[ijk] = Kij_D0D2;
  adm_Kij_D1D2[ijk] = Kij_D1D2;
  adm_Kij_D0D0[ijk] = Kij_D0D0;
  adm_Kij_D0D1[ijk] = Kij_D0D1;
  adm_Kij_D1D1[ijk] = Kij_D1D1;
}
}
