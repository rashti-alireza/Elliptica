/*
  These C codes generated by Cpi version 2.0
  Copyright (C) 2019-2020 Alireza Rashti.
*/


#include "adm_header.h"



#define dfield_and_get_v(name) dField_di(name); READ_v_UNUSED(name);


#define add_dfield_and_get_v(name) ADD_FIELD(name); dField_di(name); READ_v_UNUSED(name);



extern fFunc_adm_update_AConfIJ_T (*adm_update_AConfIJ_patch);


void adm_ham_and_mom_from_identities(Patch_T *const patch,
        const char *const Ham,const char *const Mom);

void adm_ham_and_mom_from_identities(Patch_T *const patch,
        const char *const Ham,const char *const Mom)
{
  adm_update_AConfIJ_patch(patch);


  /* declaring: */
  REALLOC_v_WRITE_v_STEM(ham,Ham)
  REALLOC_v_WRITE_v_STEM(mom_U1,Mom)
  REALLOC_v_WRITE_v_STEM(mom_U0,Mom)
  REALLOC_v_WRITE_v_STEM(mom_U2,Mom)
  READ_v_UNUSED(AConfIJ_U0U1)
  READ_v_UNUSED(AConfIJ_U0U0)
  READ_v_UNUSED(AConfIJ_U0U2)
  READ_v_UNUSED(AConfIJ_U2U2)
  READ_v_UNUSED(AConfIJ_U1U1)
  READ_v_UNUSED(AConfIJ_U1U2)
  READ_v_UNUSED(dAConfIJ_U0U0D2)
  READ_v_UNUSED(dAConfIJ_U0U0D0)
  READ_v_UNUSED(dAConfIJ_U0U0D1)
  READ_v_UNUSED(dAConfIJ_U0U1D2)
  READ_v_UNUSED(dAConfIJ_U0U1D1)
  READ_v_UNUSED(dAConfIJ_U0U1D0)
  READ_v_UNUSED(dAConfIJ_U0U2D0)
  READ_v_UNUSED(dAConfIJ_U0U2D1)
  READ_v_UNUSED(dAConfIJ_U0U2D2)
  READ_v_UNUSED(dAConfIJ_U2U2D2)
  READ_v_UNUSED(dAConfIJ_U1U2D2)
  READ_v_UNUSED(dAConfIJ_U2U2D0)
  READ_v_UNUSED(dAConfIJ_U2U2D1)
  READ_v_UNUSED(dAConfIJ_U1U2D1)
  READ_v_UNUSED(dAConfIJ_U1U1D2)
  READ_v_UNUSED(dAConfIJ_U1U2D0)
  READ_v_UNUSED(dAConfIJ_U1U1D0)
  READ_v_UNUSED(dAConfIJ_U1U1D1)
  READ_v_UNUSED(psi)
  READ_v_UNUSED(dpsi_D0)
  READ_v_UNUSED(dpsi_D1)
  READ_v_UNUSED(dpsi_D2)
  READ_v_UNUSED(ddpsi_D2D2)
  READ_v_UNUSED(ddpsi_D0D0)
  READ_v_UNUSED(ddpsi_D0D1)
  READ_v_UNUSED(ddpsi_D1D1)
  READ_v_UNUSED(ddpsi_D1D2)
  READ_v_UNUSED(ddpsi_D0D2)
  READ_v_UNUSED(gConf_D0D2)
  READ_v_UNUSED(gConf_D0D0)
  READ_v_UNUSED(gConf_D0D1)
  READ_v_UNUSED(gConf_D1D2)
  READ_v_UNUSED(gConf_D1D1)
  READ_v_UNUSED(gConf_D2D2)
  READ_v_UNUSED(igConf_U2U2)
  READ_v_UNUSED(igConf_U1U2)
  READ_v_UNUSED(igConf_U1U1)
  READ_v_UNUSED(igConf_U0U2)
  READ_v_UNUSED(igConf_U0U0)
  READ_v_UNUSED(igConf_U0U1)
  add_dfield_and_get_v(digConf_U0U0D2)
  add_dfield_and_get_v(digConf_U0U0D1)
  add_dfield_and_get_v(digConf_U0U0D0)
  add_dfield_and_get_v(digConf_U0U1D2)
  add_dfield_and_get_v(digConf_U0U1D0)
  add_dfield_and_get_v(digConf_U0U1D1)
  add_dfield_and_get_v(digConf_U1U2D1)
  add_dfield_and_get_v(digConf_U0U2D1)
  add_dfield_and_get_v(digConf_U0U2D0)
  add_dfield_and_get_v(digConf_U0U2D2)
  add_dfield_and_get_v(digConf_U1U2D2)
  add_dfield_and_get_v(digConf_U2U2D1)
  add_dfield_and_get_v(digConf_U2U2D0)
  add_dfield_and_get_v(digConf_U2U2D2)
  add_dfield_and_get_v(digConf_U1U2D0)
  add_dfield_and_get_v(digConf_U1U1D2)
  add_dfield_and_get_v(digConf_U1U1D1)
  add_dfield_and_get_v(digConf_U1U1D0)
  READ_v_UNUSED(ChrisConf_U1D0D0)
  READ_v_UNUSED(ChrisConf_U0D2D2)
  READ_v_UNUSED(ChrisConf_U1D0D2)
  READ_v_UNUSED(ChrisConf_U2D2D2)
  READ_v_UNUSED(ChrisConf_U2D1D1)
  READ_v_UNUSED(ChrisConf_U2D0D0)
  READ_v_UNUSED(ChrisConf_U1D1D1)
  READ_v_UNUSED(ChrisConf_U0D1D1)
  READ_v_UNUSED(ChrisConf_U0D1D2)
  READ_v_UNUSED(ChrisConf_U1D1D2)
  READ_v_UNUSED(ChrisConf_U0D0D1)
  READ_v_UNUSED(ChrisConf_U0D0D0)
  READ_v_UNUSED(ChrisConf_U2D0D1)
  READ_v_UNUSED(ChrisConf_U0D0D2)
  READ_v_UNUSED(ChrisConf_U2D1D2)
  READ_v_UNUSED(ChrisConf_U1D2D2)
  READ_v_UNUSED(ChrisConf_U2D0D2)
  READ_v_UNUSED(ChrisConf_U1D0D1)
  READ_v_UNUSED(EConf)
  READ_v_UNUSED(JConf_U0)
  READ_v_UNUSED(JConf_U1)
  READ_v_UNUSED(JConf_U2)
  READ_v_UNUSED(trK)
  READ_v_UNUSED(dtrK_D2)
  READ_v_UNUSED(dtrK_D1)
  READ_v_UNUSED(dtrK_D0)
  READ_v_UNUSED(trRicciConf)


FOR_ALL_ijk
{
  double psim4 = 
pow(psi[ijk], -4);

  double psim6 = 
pow(psi[ijk], -6);

  double J_U2 = 
JConf_U2[ijk]*psim6;

  double J_U0 = 
JConf_U0[ijk]*psim6;

  double J_U1 = 
JConf_U1[ijk]*psim6;

  double E = 
EConf[ijk]*psim6;

  double dLnpsi_D0 = 
dpsi_D0[ijk]/psi[ijk];

  double dLnpsi_D1 = 
dpsi_D1[ijk]/psi[ijk];

  double dLnpsi_D2 = 
dpsi_D2[ijk]/psi[ijk];

  double DDpsi = 
-ChrisConf_U0D0D0[ijk]*dpsi_D0[ijk]*igConf_U0U0[ijk] - 2.0*
ChrisConf_U0D0D1[ijk]*dpsi_D0[ijk]*igConf_U0U1[ijk] - 2.0*
ChrisConf_U0D0D2[ijk]*dpsi_D0[ijk]*igConf_U0U2[ijk] -
ChrisConf_U0D1D1[ijk]*dpsi_D0[ijk]*igConf_U1U1[ijk] - 2.0*
ChrisConf_U0D1D2[ijk]*dpsi_D0[ijk]*igConf_U1U2[ijk] -
ChrisConf_U0D2D2[ijk]*dpsi_D0[ijk]*igConf_U2U2[ijk] -
ChrisConf_U1D0D0[ijk]*dpsi_D1[ijk]*igConf_U0U0[ijk] - 2.0*
ChrisConf_U1D0D1[ijk]*dpsi_D1[ijk]*igConf_U0U1[ijk] - 2.0*
ChrisConf_U1D0D2[ijk]*dpsi_D1[ijk]*igConf_U0U2[ijk] -
ChrisConf_U1D1D1[ijk]*dpsi_D1[ijk]*igConf_U1U1[ijk] - 2.0*
ChrisConf_U1D1D2[ijk]*dpsi_D1[ijk]*igConf_U1U2[ijk] -
ChrisConf_U1D2D2[ijk]*dpsi_D1[ijk]*igConf_U2U2[ijk] -
ChrisConf_U2D0D0[ijk]*dpsi_D2[ijk]*igConf_U0U0[ijk] - 2.0*
ChrisConf_U2D0D1[ijk]*dpsi_D2[ijk]*igConf_U0U1[ijk] - 2.0*
ChrisConf_U2D0D2[ijk]*dpsi_D2[ijk]*igConf_U0U2[ijk] -
ChrisConf_U2D1D1[ijk]*dpsi_D2[ijk]*igConf_U1U1[ijk] - 2.0*
ChrisConf_U2D1D2[ijk]*dpsi_D2[ijk]*igConf_U1U2[ijk] -
ChrisConf_U2D2D2[ijk]*dpsi_D2[ijk]*igConf_U2U2[ijk] + ddpsi_D0D0[ijk]*
igConf_U0U0[ijk] + 2.0*ddpsi_D0D1[ijk]*igConf_U0U1[ijk] + 2.0*
ddpsi_D0D2[ijk]*igConf_U0U2[ijk] + ddpsi_D1D1[ijk]*igConf_U1U1[ijk] +
2.0*ddpsi_D1D2[ijk]*igConf_U1U2[ijk] + ddpsi_D2D2[ijk]*
igConf_U2U2[ijk];

  double R = 
-8*DDpsi*psim4/psi[ijk] + psim4*trRicciConf[ijk];

  double Kbar_U0U0 = 
AConfIJ_U0U0[ijk]*psim6 + (1.0/3.0)*igConf_U0U0[ijk]*
trK[ijk];

  double Kbar_U0U1 = 
AConfIJ_U0U1[ijk]*psim6 + (1.0/3.0)*igConf_U0U1[ijk]*
trK[ijk];

  double Kbar_U0U2 = 
AConfIJ_U0U2[ijk]*psim6 + (1.0/3.0)*igConf_U0U2[ijk]*
trK[ijk];

  double Kbar_U2U2 = 
AConfIJ_U2U2[ijk]*psim6 + (1.0/3.0)*igConf_U2U2[ijk]*
trK[ijk];

  double Kbar_U1U1 = 
AConfIJ_U1U1[ijk]*psim6 + (1.0/3.0)*igConf_U1U1[ijk]*
trK[ijk];

  double Kbar_U1U2 = 
AConfIJ_U1U2[ijk]*psim6 + (1.0/3.0)*igConf_U1U2[ijk]*
trK[ijk];

  double KijKij = 
pow(Kbar_U0U0, 2)*pow(gConf_D0D0[ijk], 2) + 4.0*Kbar_U0U0*Kbar_U0U1*
gConf_D0D0[ijk]*gConf_D0D1[ijk] + 4.0*Kbar_U0U0*Kbar_U0U2*
gConf_D0D0[ijk]*gConf_D0D2[ijk] + 2.0*Kbar_U0U0*Kbar_U1U1*
pow(gConf_D0D1[ijk], 2) + 4.0*Kbar_U0U0*Kbar_U1U2*gConf_D0D1[ijk]*
gConf_D0D2[ijk] + 2.0*Kbar_U0U0*Kbar_U2U2*pow(gConf_D0D2[ijk], 2) + 2.0*
pow(Kbar_U0U1, 2)*gConf_D0D0[ijk]*gConf_D1D1[ijk] + 2.0*
pow(Kbar_U0U1, 2)*pow(gConf_D0D1[ijk], 2) + 4.0*Kbar_U0U1*Kbar_U0U2*
gConf_D0D0[ijk]*gConf_D1D2[ijk] + 4.0*Kbar_U0U1*Kbar_U0U2*
gConf_D0D1[ijk]*gConf_D0D2[ijk] + 4.0*Kbar_U0U1*Kbar_U1U1*
gConf_D0D1[ijk]*gConf_D1D1[ijk] + 4.0*Kbar_U0U1*Kbar_U1U2*
gConf_D0D1[ijk]*gConf_D1D2[ijk] + 4.0*Kbar_U0U1*Kbar_U1U2*
gConf_D0D2[ijk]*gConf_D1D1[ijk] + 4.0*Kbar_U0U1*Kbar_U2U2*
gConf_D0D2[ijk]*gConf_D1D2[ijk] + 2.0*pow(Kbar_U0U2, 2)*gConf_D0D0[ijk]*
gConf_D2D2[ijk] + 2.0*pow(Kbar_U0U2, 2)*pow(gConf_D0D2[ijk], 2) + 4.0*
Kbar_U0U2*Kbar_U1U1*gConf_D0D1[ijk]*gConf_D1D2[ijk] + 4.0*Kbar_U0U2*
Kbar_U1U2*gConf_D0D1[ijk]*gConf_D2D2[ijk] + 4.0*Kbar_U0U2*Kbar_U1U2*
gConf_D0D2[ijk]*gConf_D1D2[ijk] + 4.0*Kbar_U0U2*Kbar_U2U2*
gConf_D0D2[ijk]*gConf_D2D2[ijk] + pow(Kbar_U1U1, 2)*
pow(gConf_D1D1[ijk], 2) + 4.0*Kbar_U1U1*Kbar_U1U2*gConf_D1D1[ijk]*
gConf_D1D2[ijk] + 2.0*Kbar_U1U1*Kbar_U2U2*pow(gConf_D1D2[ijk], 2) + 2.0*
pow(Kbar_U1U2, 2)*gConf_D1D1[ijk]*gConf_D2D2[ijk] + 2.0*
pow(Kbar_U1U2, 2)*pow(gConf_D1D2[ijk], 2) + 4.0*Kbar_U1U2*Kbar_U2U2*
gConf_D1D2[ijk]*gConf_D2D2[ijk] + pow(Kbar_U2U2, 2)*
pow(gConf_D2D2[ijk], 2);

  double Ham_Constraint = 
-16*M_PI*E - KijKij + R + pow(trK[ijk], 2);

  double c_U2U2U2 = 
-2.0*dLnpsi_D0*gConf_D2D2[ijk]*igConf_U0U2[ijk] - 2.0*dLnpsi_D1*
gConf_D2D2[ijk]*igConf_U1U2[ijk] - 2.0*dLnpsi_D2*gConf_D2D2[ijk]*
igConf_U2U2[ijk] + 4.0*dLnpsi_D2;

  double c_U0U0U1 = 
-2.0*dLnpsi_D0*gConf_D0D1[ijk]*igConf_U0U0[ijk] - 2.0*dLnpsi_D1*
gConf_D0D1[ijk]*igConf_U0U1[ijk] + 2.0*dLnpsi_D1 - 2.0*dLnpsi_D2*
gConf_D0D1[ijk]*igConf_U0U2[ijk];

  double c_U0U0U0 = 
-2.0*dLnpsi_D0*gConf_D0D0[ijk]*igConf_U0U0[ijk] + 4.0*dLnpsi_D0 - 2.0*
dLnpsi_D1*gConf_D0D0[ijk]*igConf_U0U1[ijk] - 2.0*dLnpsi_D2*
gConf_D0D0[ijk]*igConf_U0U2[ijk];

  double c_U1U0U2 = 
-2.0*gConf_D0D2[ijk]*(dLnpsi_D0*igConf_U0U1[ijk] + dLnpsi_D1*
igConf_U1U1[ijk] + dLnpsi_D2*igConf_U1U2[ijk]);

  double c_U0U0U2 = 
-2.0*dLnpsi_D0*gConf_D0D2[ijk]*igConf_U0U0[ijk] - 2.0*dLnpsi_D1*
gConf_D0D2[ijk]*igConf_U0U1[ijk] - 2.0*dLnpsi_D2*gConf_D0D2[ijk]*
igConf_U0U2[ijk] + 2.0*dLnpsi_D2;

  double c_U0U2U2 = 
-2.0*gConf_D2D2[ijk]*(dLnpsi_D0*igConf_U0U0[ijk] + dLnpsi_D1*
igConf_U0U1[ijk] + dLnpsi_D2*igConf_U0U2[ijk]);

  double c_U2U0U1 = 
-2.0*gConf_D0D1[ijk]*(dLnpsi_D0*igConf_U0U2[ijk] + dLnpsi_D1*
igConf_U1U2[ijk] + dLnpsi_D2*igConf_U2U2[ijk]);

  double c_U2U0U0 = 
-2.0*gConf_D0D0[ijk]*(dLnpsi_D0*igConf_U0U2[ijk] + dLnpsi_D1*
igConf_U1U2[ijk] + dLnpsi_D2*igConf_U2U2[ijk]);

  double c_U1U1U1 = 
-2.0*dLnpsi_D0*gConf_D1D1[ijk]*igConf_U0U1[ijk] - 2.0*dLnpsi_D1*
gConf_D1D1[ijk]*igConf_U1U1[ijk] + 4.0*dLnpsi_D1 - 2.0*dLnpsi_D2*
gConf_D1D1[ijk]*igConf_U1U2[ijk];

  double c_U1U2U2 = 
-2.0*gConf_D2D2[ijk]*(dLnpsi_D0*igConf_U0U1[ijk] + dLnpsi_D1*
igConf_U1U1[ijk] + dLnpsi_D2*igConf_U1U2[ijk]);

  double c_U0U1U1 = 
-2.0*gConf_D1D1[ijk]*(dLnpsi_D0*igConf_U0U0[ijk] + dLnpsi_D1*
igConf_U0U1[ijk] + dLnpsi_D2*igConf_U0U2[ijk]);

  double c_U0U1U2 = 
-2.0*gConf_D1D2[ijk]*(dLnpsi_D0*igConf_U0U0[ijk] + dLnpsi_D1*
igConf_U0U1[ijk] + dLnpsi_D2*igConf_U0U2[ijk]);

  double c_U1U0U1 = 
-2.0*dLnpsi_D0*gConf_D0D1[ijk]*igConf_U0U1[ijk] + 2.0*dLnpsi_D0 - 2.0*
dLnpsi_D1*gConf_D0D1[ijk]*igConf_U1U1[ijk] - 2.0*dLnpsi_D2*
gConf_D0D1[ijk]*igConf_U1U2[ijk];

  double c_U2U1U2 = 
-2.0*dLnpsi_D0*gConf_D1D2[ijk]*igConf_U0U2[ijk] - 2.0*dLnpsi_D1*
gConf_D1D2[ijk]*igConf_U1U2[ijk] + 2.0*dLnpsi_D1 - 2.0*dLnpsi_D2*
gConf_D1D2[ijk]*igConf_U2U2[ijk];

  double c_U1U0U0 = 
-2.0*gConf_D0D0[ijk]*(dLnpsi_D0*igConf_U0U1[ijk] + dLnpsi_D1*
igConf_U1U1[ijk] + dLnpsi_D2*igConf_U1U2[ijk]);

  double c_U2U1U1 = 
-2.0*gConf_D1D1[ijk]*(dLnpsi_D0*igConf_U0U2[ijk] + dLnpsi_D1*
igConf_U1U2[ijk] + dLnpsi_D2*igConf_U2U2[ijk]);

  double c_U1U1U2 = 
-2.0*dLnpsi_D0*gConf_D1D2[ijk]*igConf_U0U1[ijk] - 2.0*dLnpsi_D1*
gConf_D1D2[ijk]*igConf_U1U1[ijk] - 2.0*dLnpsi_D2*gConf_D1D2[ijk]*
igConf_U1U2[ijk] + 2.0*dLnpsi_D2;

  double c_U2U0U2 = 
-2.0*dLnpsi_D0*gConf_D0D2[ijk]*igConf_U0U2[ijk] + 2.0*dLnpsi_D0 - 2.0*
dLnpsi_D1*gConf_D0D2[ijk]*igConf_U1U2[ijk] - 2.0*dLnpsi_D2*
gConf_D0D2[ijk]*igConf_U2U2[ijk];

  double djKj_U0 = 
(1.0/3.0)*psim4*(dtrK_D0[ijk]*igConf_U0U0[ijk] + dtrK_D1[ijk]*
igConf_U0U1[ijk] + dtrK_D2[ijk]*igConf_U0U2[ijk] - 3*psim6*(10.0*
AConfIJ_U0U0[ijk]*dLnpsi_D0 + 10.0*AConfIJ_U0U1[ijk]*dLnpsi_D1 + 10.0*
AConfIJ_U0U2[ijk]*dLnpsi_D2 - dAConfIJ_U0U0D0[ijk] - 
dAConfIJ_U0U1D1[ijk] - dAConfIJ_U0U2D2[ijk]) + trK[ijk]*
(digConf_U0U0D0[ijk] + digConf_U0U1D1[ijk] + digConf_U0U2D2[ijk]) - 4.0*
trK[ijk]*(dLnpsi_D0*igConf_U0U0[ijk] + dLnpsi_D1*igConf_U0U1[ijk] + 
dLnpsi_D2*igConf_U0U2[ijk]));

  double djKj_U1 = 
(1.0/3.0)*psim4*(dtrK_D0[ijk]*igConf_U0U1[ijk] + dtrK_D1[ijk]*
igConf_U1U1[ijk] + dtrK_D2[ijk]*igConf_U1U2[ijk] - 3*psim6*(10.0*
AConfIJ_U0U1[ijk]*dLnpsi_D0 + 10.0*AConfIJ_U1U1[ijk]*dLnpsi_D1 + 10.0*
AConfIJ_U1U2[ijk]*dLnpsi_D2 - dAConfIJ_U0U1D0[ijk] - 
dAConfIJ_U1U1D1[ijk] - dAConfIJ_U1U2D2[ijk]) + trK[ijk]*
(digConf_U0U1D0[ijk] + digConf_U1U1D1[ijk] + digConf_U1U2D2[ijk]) - 4.0*
trK[ijk]*(dLnpsi_D0*igConf_U0U1[ijk] + dLnpsi_D1*igConf_U1U1[ijk] + 
dLnpsi_D2*igConf_U1U2[ijk]));

  double djKj_U2 = 
(1.0/3.0)*psim4*(dtrK_D0[ijk]*igConf_U0U2[ijk] + dtrK_D1[ijk]*
igConf_U1U2[ijk] + dtrK_D2[ijk]*igConf_U2U2[ijk] - 3*psim6*(10.0*
AConfIJ_U0U2[ijk]*dLnpsi_D0 + 10.0*AConfIJ_U1U2[ijk]*dLnpsi_D1 + 10.0*
AConfIJ_U2U2[ijk]*dLnpsi_D2 - dAConfIJ_U0U2D0[ijk] - 
dAConfIJ_U1U2D1[ijk] - dAConfIJ_U2U2D2[ijk]) + trK[ijk]*
(digConf_U0U2D0[ijk] + digConf_U1U2D1[ijk] + digConf_U2U2D2[ijk]) - 4.0*
trK[ijk]*(dLnpsi_D0*igConf_U0U2[ijk] + dLnpsi_D1*igConf_U1U2[ijk] + 
dLnpsi_D2*igConf_U2U2[ijk]));

  double GammaKbar_U2 = 
ChrisConf_U0D0D0[ijk]*Kbar_U0U2 + ChrisConf_U0D0D1[ijk]*Kbar_U1U2 + 
ChrisConf_U0D0D2[ijk]*Kbar_U2U2 + ChrisConf_U1D0D1[ijk]*Kbar_U0U2 + 
ChrisConf_U1D1D1[ijk]*Kbar_U1U2 + ChrisConf_U1D1D2[ijk]*Kbar_U2U2 + 
ChrisConf_U2D0D0[ijk]*Kbar_U0U0 + 2.0*ChrisConf_U2D0D1[ijk]*Kbar_U0U1 + 
3.0*ChrisConf_U2D0D2[ijk]*Kbar_U0U2 + ChrisConf_U2D1D1[ijk]*Kbar_U1U1 + 
3.0*ChrisConf_U2D1D2[ijk]*Kbar_U1U2 + 2.0*ChrisConf_U2D2D2[ijk]*
Kbar_U2U2;

  double GammaKbar_U1 = 
ChrisConf_U0D0D0[ijk]*Kbar_U0U1 + ChrisConf_U0D0D1[ijk]*Kbar_U1U1 + 
ChrisConf_U0D0D2[ijk]*Kbar_U1U2 + ChrisConf_U1D0D0[ijk]*Kbar_U0U0 + 3.0*
ChrisConf_U1D0D1[ijk]*Kbar_U0U1 + 2.0*ChrisConf_U1D0D2[ijk]*Kbar_U0U2 + 
2.0*ChrisConf_U1D1D1[ijk]*Kbar_U1U1 + 3.0*ChrisConf_U1D1D2[ijk]*
Kbar_U1U2 + ChrisConf_U1D2D2[ijk]*Kbar_U2U2 + ChrisConf_U2D0D2[ijk]*
Kbar_U0U1 + ChrisConf_U2D1D2[ijk]*Kbar_U1U1 + ChrisConf_U2D2D2[ijk]*
Kbar_U1U2;

  double GammaKbar_U0 = 
2.0*ChrisConf_U0D0D0[ijk]*Kbar_U0U0 + 3.0*ChrisConf_U0D0D1[ijk]*
Kbar_U0U1 + 3.0*ChrisConf_U0D0D2[ijk]*Kbar_U0U2 + ChrisConf_U0D1D1[ijk]*
Kbar_U1U1 + 2.0*ChrisConf_U0D1D2[ijk]*Kbar_U1U2 + ChrisConf_U0D2D2[ijk]*
Kbar_U2U2 + ChrisConf_U1D0D1[ijk]*Kbar_U0U0 + ChrisConf_U1D1D1[ijk]*
Kbar_U0U1 + ChrisConf_U1D1D2[ijk]*Kbar_U0U2 + ChrisConf_U2D0D2[ijk]*
Kbar_U0U0 + ChrisConf_U2D1D2[ijk]*Kbar_U0U1 + ChrisConf_U2D2D2[ijk]*
Kbar_U0U2;

  double DbarjKj_U2 = 
GammaKbar_U2*psim4 + djKj_U2;

  double DbarjKj_U0 = 
GammaKbar_U0*psim4 + djKj_U0;

  double DbarjKj_U1 = 
GammaKbar_U1*psim4 + djKj_U1;

  double CKbar_U2 = 
Kbar_U0U0*c_U2U0U0 + 2.0*Kbar_U0U1*c_U2U0U1 + Kbar_U0U2*c_U0U0U0 + 
Kbar_U0U2*c_U1U0U1 + 3.0*Kbar_U0U2*c_U2U0U2 + Kbar_U1U1*c_U2U1U1 + 
Kbar_U1U2*c_U0U0U1 + Kbar_U1U2*c_U1U1U1 + 3.0*Kbar_U1U2*c_U2U1U2 + 
Kbar_U2U2*c_U0U0U2 + Kbar_U2U2*c_U1U1U2 + 2.0*Kbar_U2U2*
c_U2U2U2;

  double CKbar_U1 = 
Kbar_U0U0*c_U1U0U0 + Kbar_U0U1*c_U0U0U0 + 3.0*Kbar_U0U1*c_U1U0U1 + 
Kbar_U0U1*c_U2U0U2 + 2.0*Kbar_U0U2*c_U1U0U2 + Kbar_U1U1*c_U0U0U1 + 2.0*
Kbar_U1U1*c_U1U1U1 + Kbar_U1U1*c_U2U1U2 + Kbar_U1U2*c_U0U0U2 + 3.0*
Kbar_U1U2*c_U1U1U2 + Kbar_U1U2*c_U2U2U2 + Kbar_U2U2*
c_U1U2U2;

  double CKbar_U0 = 
2.0*Kbar_U0U0*c_U0U0U0 + Kbar_U0U0*c_U1U0U1 + Kbar_U0U0*c_U2U0U2 + 3.0*
Kbar_U0U1*c_U0U0U1 + Kbar_U0U1*c_U1U1U1 + Kbar_U0U1*c_U2U1U2 + 3.0*
Kbar_U0U2*c_U0U0U2 + Kbar_U0U2*c_U1U1U2 + Kbar_U0U2*c_U2U2U2 + 
Kbar_U1U1*c_U0U1U1 + 2.0*Kbar_U1U2*c_U0U1U2 + Kbar_U2U2*
c_U0U2U2;

  double Dk_U0 = 
CKbar_U0*psim4 + DbarjKj_U0;

  double Dk_U1 = 
CKbar_U1*psim4 + DbarjKj_U1;

  double Dk_U2 = 
CKbar_U2*psim4 + DbarjKj_U2;

  double Mom_constraint_U2 = 
Dk_U2 - 8*M_PI*J_U2 - psim4*(dtrK_D0[ijk]*igConf_U0U2[ijk] + 
dtrK_D1[ijk]*igConf_U1U2[ijk] + dtrK_D2[ijk]*igConf_U2U2[ijk]);

  double Mom_constraint_U0 = 
Dk_U0 - 8*M_PI*J_U0 - psim4*(dtrK_D0[ijk]*igConf_U0U0[ijk] + 
dtrK_D1[ijk]*igConf_U0U1[ijk] + dtrK_D2[ijk]*igConf_U0U2[ijk]);

  double Mom_constraint_U1 = 
Dk_U1 - 8*M_PI*J_U1 - psim4*(dtrK_D0[ijk]*igConf_U0U1[ijk] + 
dtrK_D1[ijk]*igConf_U1U1[ijk] + dtrK_D2[ijk]*igConf_U1U2[ijk]);


  /* populating: */
  mom_U1[ijk] = Mom_constraint_U1;
  mom_U0[ijk] = Mom_constraint_U0;
  mom_U2[ijk] = Mom_constraint_U2;
  ham[ijk] = Ham_Constraint;
}
remove_field_regex(patch,"^digConf_U.+");
}
