/*
  These C codes generated by Cpi version 2.0
  Copyright (C) 2019-2020 Alireza Rashti.
*/


#include "obs_header.h"


#define add_and_get_field(name) \
  if (_Ind(#name) < 0) \
  {ADD_AND_ALLOC_FIELD(name);} \
  WRITE_v(name);


void obs_populate_spin_integrands_akv(Patch_T *const patch,const double *const normal[3]);
void obs_populate_spin_integrands_akv(Patch_T *const patch,const double *const normal[3])
{
  const Uint nn = patch->nn;
  Uint ijk;

  /* declaring: */
  READ_v(AConfIJ_U0U1)
  READ_v(AConfIJ_U0U0)
  READ_v(AConfIJ_U0U2)
  READ_v(AConfIJ_U2U2)
  READ_v(AConfIJ_U1U1)
  READ_v(AConfIJ_U1U2)
  READ_v(gConf_D0D2)
  READ_v(gConf_D0D0)
  READ_v(gConf_D0D1)
  READ_v(gConf_D1D2)
  READ_v(gConf_D1D1)
  READ_v(gConf_D2D2)
  READ_v(psi)
  READ_v(AKV0_U1)
  READ_v(AKV0_U0)
  READ_v(AKV0_U2)
  READ_v(AKV1_U2)
  READ_v(AKV1_U0)
  READ_v(AKV1_U1)
  READ_v(AKV2_U2)
  READ_v(AKV2_U1)
  READ_v(AKV2_U0)
  add_and_get_field(SPIN_integrand_U0)
  add_and_get_field(SPIN_integrand_U1)
  add_and_get_field(SPIN_integrand_U2)



   const double *const n_U0 = normal[0];
   const double *const n_U1 = normal[1];
   const double *const n_U2 = normal[2];
   for (ijk = 0; ijk < nn; ++ijk)
   {
   double psim2 = 
pow(psi[ijk], -2);

   double Pn_D0 = 
psim2*(AConfIJ_U0U0[ijk]*pow(gConf_D0D0[ijk], 2)*n_U0[ijk] + 
AConfIJ_U0U0[ijk]*gConf_D0D0[ijk]*gConf_D0D1[ijk]*n_U1[ijk] + 
AConfIJ_U0U0[ijk]*gConf_D0D0[ijk]*gConf_D0D2[ijk]*n_U2[ijk] + 2.0*
AConfIJ_U0U1[ijk]*gConf_D0D0[ijk]*gConf_D0D1[ijk]*n_U0[ijk] + 
AConfIJ_U0U1[ijk]*gConf_D0D0[ijk]*gConf_D1D1[ijk]*n_U1[ijk] + 
AConfIJ_U0U1[ijk]*gConf_D0D0[ijk]*gConf_D1D2[ijk]*n_U2[ijk] + 
AConfIJ_U0U1[ijk]*pow(gConf_D0D1[ijk], 2)*n_U1[ijk] + AConfIJ_U0U1[ijk]*
gConf_D0D1[ijk]*gConf_D0D2[ijk]*n_U2[ijk] + 2.0*AConfIJ_U0U2[ijk]*
gConf_D0D0[ijk]*gConf_D0D2[ijk]*n_U0[ijk] + AConfIJ_U0U2[ijk]*
gConf_D0D0[ijk]*gConf_D1D2[ijk]*n_U1[ijk] + AConfIJ_U0U2[ijk]*
gConf_D0D0[ijk]*gConf_D2D2[ijk]*n_U2[ijk] + AConfIJ_U0U2[ijk]*
gConf_D0D1[ijk]*gConf_D0D2[ijk]*n_U1[ijk] + AConfIJ_U0U2[ijk]*
pow(gConf_D0D2[ijk], 2)*n_U2[ijk] + AConfIJ_U1U1[ijk]*
pow(gConf_D0D1[ijk], 2)*n_U0[ijk] + AConfIJ_U1U1[ijk]*gConf_D0D1[ijk]*
gConf_D1D1[ijk]*n_U1[ijk] + AConfIJ_U1U1[ijk]*gConf_D0D1[ijk]*
gConf_D1D2[ijk]*n_U2[ijk] + 2.0*AConfIJ_U1U2[ijk]*gConf_D0D1[ijk]*
gConf_D0D2[ijk]*n_U0[ijk] + AConfIJ_U1U2[ijk]*gConf_D0D1[ijk]*
gConf_D1D2[ijk]*n_U1[ijk] + AConfIJ_U1U2[ijk]*gConf_D0D1[ijk]*
gConf_D2D2[ijk]*n_U2[ijk] + AConfIJ_U1U2[ijk]*gConf_D0D2[ijk]*
gConf_D1D1[ijk]*n_U1[ijk] + AConfIJ_U1U2[ijk]*gConf_D0D2[ijk]*
gConf_D1D2[ijk]*n_U2[ijk] + AConfIJ_U2U2[ijk]*pow(gConf_D0D2[ijk], 2)*
n_U0[ijk] + AConfIJ_U2U2[ijk]*gConf_D0D2[ijk]*gConf_D1D2[ijk]*
n_U1[ijk] + AConfIJ_U2U2[ijk]*gConf_D0D2[ijk]*gConf_D2D2[ijk]*
n_U2[ijk]);

   double Pn_D1 = 
psim2*(AConfIJ_U0U0[ijk]*gConf_D0D0[ijk]*gConf_D0D1[ijk]*n_U0[ijk] + 
AConfIJ_U0U0[ijk]*pow(gConf_D0D1[ijk], 2)*n_U1[ijk] + AConfIJ_U0U0[ijk]*
gConf_D0D1[ijk]*gConf_D0D2[ijk]*n_U2[ijk] + AConfIJ_U0U1[ijk]*
gConf_D0D0[ijk]*gConf_D1D1[ijk]*n_U0[ijk] + AConfIJ_U0U1[ijk]*
pow(gConf_D0D1[ijk], 2)*n_U0[ijk] + 2.0*AConfIJ_U0U1[ijk]*
gConf_D0D1[ijk]*gConf_D1D1[ijk]*n_U1[ijk] + AConfIJ_U0U1[ijk]*
gConf_D0D1[ijk]*gConf_D1D2[ijk]*n_U2[ijk] + AConfIJ_U0U1[ijk]*
gConf_D0D2[ijk]*gConf_D1D1[ijk]*n_U2[ijk] + AConfIJ_U0U2[ijk]*
gConf_D0D0[ijk]*gConf_D1D2[ijk]*n_U0[ijk] + AConfIJ_U0U2[ijk]*
gConf_D0D1[ijk]*gConf_D0D2[ijk]*n_U0[ijk] + 2.0*AConfIJ_U0U2[ijk]*
gConf_D0D1[ijk]*gConf_D1D2[ijk]*n_U1[ijk] + AConfIJ_U0U2[ijk]*
gConf_D0D1[ijk]*gConf_D2D2[ijk]*n_U2[ijk] + AConfIJ_U0U2[ijk]*
gConf_D0D2[ijk]*gConf_D1D2[ijk]*n_U2[ijk] + AConfIJ_U1U1[ijk]*
gConf_D0D1[ijk]*gConf_D1D1[ijk]*n_U0[ijk] + AConfIJ_U1U1[ijk]*
pow(gConf_D1D1[ijk], 2)*n_U1[ijk] + AConfIJ_U1U1[ijk]*gConf_D1D1[ijk]*
gConf_D1D2[ijk]*n_U2[ijk] + AConfIJ_U1U2[ijk]*gConf_D0D1[ijk]*
gConf_D1D2[ijk]*n_U0[ijk] + AConfIJ_U1U2[ijk]*gConf_D0D2[ijk]*
gConf_D1D1[ijk]*n_U0[ijk] + 2.0*AConfIJ_U1U2[ijk]*gConf_D1D1[ijk]*
gConf_D1D2[ijk]*n_U1[ijk] + AConfIJ_U1U2[ijk]*gConf_D1D1[ijk]*
gConf_D2D2[ijk]*n_U2[ijk] + AConfIJ_U1U2[ijk]*pow(gConf_D1D2[ijk], 2)*
n_U2[ijk] + AConfIJ_U2U2[ijk]*gConf_D0D2[ijk]*gConf_D1D2[ijk]*
n_U0[ijk] + AConfIJ_U2U2[ijk]*pow(gConf_D1D2[ijk], 2)*n_U1[ijk] + 
AConfIJ_U2U2[ijk]*gConf_D1D2[ijk]*gConf_D2D2[ijk]*n_U2[ijk]);

   double Pn_D2 = 
psim2*(AConfIJ_U0U0[ijk]*gConf_D0D0[ijk]*gConf_D0D2[ijk]*n_U0[ijk] + 
AConfIJ_U0U0[ijk]*gConf_D0D1[ijk]*gConf_D0D2[ijk]*n_U1[ijk] + 
AConfIJ_U0U0[ijk]*pow(gConf_D0D2[ijk], 2)*n_U2[ijk] + AConfIJ_U0U1[ijk]*
gConf_D0D0[ijk]*gConf_D1D2[ijk]*n_U0[ijk] + AConfIJ_U0U1[ijk]*
gConf_D0D1[ijk]*gConf_D0D2[ijk]*n_U0[ijk] + AConfIJ_U0U1[ijk]*
gConf_D0D1[ijk]*gConf_D1D2[ijk]*n_U1[ijk] + AConfIJ_U0U1[ijk]*
gConf_D0D2[ijk]*gConf_D1D1[ijk]*n_U1[ijk] + 2.0*AConfIJ_U0U1[ijk]*
gConf_D0D2[ijk]*gConf_D1D2[ijk]*n_U2[ijk] + AConfIJ_U0U2[ijk]*
gConf_D0D0[ijk]*gConf_D2D2[ijk]*n_U0[ijk] + AConfIJ_U0U2[ijk]*
gConf_D0D1[ijk]*gConf_D2D2[ijk]*n_U1[ijk] + AConfIJ_U0U2[ijk]*
pow(gConf_D0D2[ijk], 2)*n_U0[ijk] + AConfIJ_U0U2[ijk]*gConf_D0D2[ijk]*
gConf_D1D2[ijk]*n_U1[ijk] + 2.0*AConfIJ_U0U2[ijk]*gConf_D0D2[ijk]*
gConf_D2D2[ijk]*n_U2[ijk] + AConfIJ_U1U1[ijk]*gConf_D0D1[ijk]*
gConf_D1D2[ijk]*n_U0[ijk] + AConfIJ_U1U1[ijk]*gConf_D1D1[ijk]*
gConf_D1D2[ijk]*n_U1[ijk] + AConfIJ_U1U1[ijk]*pow(gConf_D1D2[ijk], 2)*
n_U2[ijk] + AConfIJ_U1U2[ijk]*gConf_D0D1[ijk]*gConf_D2D2[ijk]*
n_U0[ijk] + AConfIJ_U1U2[ijk]*gConf_D0D2[ijk]*gConf_D1D2[ijk]*
n_U0[ijk] + AConfIJ_U1U2[ijk]*gConf_D1D1[ijk]*gConf_D2D2[ijk]*
n_U1[ijk] + AConfIJ_U1U2[ijk]*pow(gConf_D1D2[ijk], 2)*n_U1[ijk] + 2.0*
AConfIJ_U1U2[ijk]*gConf_D1D2[ijk]*gConf_D2D2[ijk]*n_U2[ijk] + 
AConfIJ_U2U2[ijk]*gConf_D0D2[ijk]*gConf_D2D2[ijk]*n_U0[ijk] + 
AConfIJ_U2U2[ijk]*gConf_D1D2[ijk]*gConf_D2D2[ijk]*n_U1[ijk] + 
AConfIJ_U2U2[ijk]*pow(gConf_D2D2[ijk], 2)*n_U2[ijk]);

   double s0 = 
AKV0_U0[ijk]*Pn_D0 + AKV0_U1[ijk]*Pn_D1 + AKV0_U2[ijk]*
Pn_D2;

   double s1 = 
AKV1_U0[ijk]*Pn_D0 + AKV1_U1[ijk]*Pn_D1 + AKV1_U2[ijk]*
Pn_D2;

   double s2 = 
AKV2_U0[ijk]*Pn_D0 + AKV2_U1[ijk]*Pn_D1 + AKV2_U2[ijk]*
Pn_D2;

   SPIN_integrand_U0[ijk] = s0;
   SPIN_integrand_U1[ijk] = s1;
   SPIN_integrand_U2[ijk] = s2;
   }

}
