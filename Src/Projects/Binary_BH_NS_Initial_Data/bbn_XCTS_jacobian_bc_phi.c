/*
  These C codes generated by Cpi version 1.0
  Copyright (C) 2019 Alireza Rashti.
*/


#include "bbn_headers.h"
#include "maths_equation_solvings_lib.h"
#include "bbn_XCTS_equations_lib.h"


void *bbn_jacobian_bc_phi(void *vp1,void *vp2)
{
  DDM_SCHUR_JACOBIAN_BC_DECLARE
  Uint ijk,lmn;/* for Jacobian entries J[ijk][lmn] */

  /* declaring: */
  JACOBIAN_DERIVATIVE(Jphi_D1)
  JACOBIAN_DERIVATIVE(Jphi_D0)
  JACOBIAN_DERIVATIVE(Jphi_D2)
  READ_v_IF_IN_NS(drho0_D2)
  READ_v_IF_IN_NS(drho0_D0)
  READ_v_IF_IN_NS(drho0_D1)
  READ_v(psi)
  READ_v(_gammaI_U0U2)
  READ_v(_gammaI_U0U0)
  READ_v(_gammaI_U0U1)
  READ_v(_gammaI_U1U2)
  READ_v(_gammaI_U1U1)
  READ_v(_gammaI_U2U2)


  if (patch->outerB)
  {
  DDM_SCHUR_JACOBIAN_BC_Bpart_OPEN

  double outerB_Bpart = 
1.0*(Jphi_D0(j_Jphi_D0,ijk,lmn)*_gammaI_U0U0[ijk]*drho0_D0[ijk] +
Jphi_D0(j_Jphi_D0,ijk,lmn)*_gammaI_U0U1[ijk]*drho0_D1[ijk] +
Jphi_D0(j_Jphi_D0,ijk,lmn)*_gammaI_U0U2[ijk]*drho0_D2[ijk] +
Jphi_D1(j_Jphi_D1,ijk,lmn)*_gammaI_U0U1[ijk]*drho0_D0[ijk] +
Jphi_D1(j_Jphi_D1,ijk,lmn)*_gammaI_U1U1[ijk]*drho0_D1[ijk] +
Jphi_D1(j_Jphi_D1,ijk,lmn)*_gammaI_U1U2[ijk]*drho0_D2[ijk] +
Jphi_D2(j_Jphi_D2,ijk,lmn)*_gammaI_U0U2[ijk]*drho0_D0[ijk] +
Jphi_D2(j_Jphi_D2,ijk,lmn)*_gammaI_U1U2[ijk]*drho0_D1[ijk] +
Jphi_D2(j_Jphi_D2,ijk,lmn)*_gammaI_U2U2[ijk]*drho0_D2[ijk])/
pow(psi[ijk], 4);

  B[i][j] = outerB_Bpart;

  DDM_SCHUR_JACOBIAN_BC_Bpart_CLOSE

  DDM_SCHUR_JACOBIAN_BC_Epart_OPEN

  double outerB_Epart = 
1.0*(Jphi_D0(j_Jphi_D0,ijk,lmn)*_gammaI_U0U0[ijk]*drho0_D0[ijk] +
Jphi_D0(j_Jphi_D0,ijk,lmn)*_gammaI_U0U1[ijk]*drho0_D1[ijk] +
Jphi_D0(j_Jphi_D0,ijk,lmn)*_gammaI_U0U2[ijk]*drho0_D2[ijk] +
Jphi_D1(j_Jphi_D1,ijk,lmn)*_gammaI_U0U1[ijk]*drho0_D0[ijk] +
Jphi_D1(j_Jphi_D1,ijk,lmn)*_gammaI_U1U1[ijk]*drho0_D1[ijk] +
Jphi_D1(j_Jphi_D1,ijk,lmn)*_gammaI_U1U2[ijk]*drho0_D2[ijk] +
Jphi_D2(j_Jphi_D2,ijk,lmn)*_gammaI_U0U2[ijk]*drho0_D0[ijk] +
Jphi_D2(j_Jphi_D2,ijk,lmn)*_gammaI_U1U2[ijk]*drho0_D1[ijk] +
Jphi_D2(j_Jphi_D2,ijk,lmn)*_gammaI_U2U2[ijk]*drho0_D2[ijk])/
pow(psi[ijk], 4);

  E_Trans[j][i] = outerB_Epart;

  DDM_SCHUR_JACOBIAN_BC_Epart_CLOSE
  }/* end of if (patch->outerB) */
  else if (patch->innerB)
  {
  DDM_SCHUR_JACOBIAN_BC_Bpart_OPEN

  double innerB_Bpart = 
0;

  B[i][j] = innerB_Bpart;

  DDM_SCHUR_JACOBIAN_BC_Bpart_CLOSE

  DDM_SCHUR_JACOBIAN_BC_Epart_OPEN

  double innerB_Epart = 
0;

  E_Trans[j][i] = innerB_Epart;

  DDM_SCHUR_JACOBIAN_BC_Epart_CLOSE

  }/* end of else if (patch->innerB) */

  return 0;
}
