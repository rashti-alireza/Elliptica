/*
  These C codes generated by Cpi version 1.0
  Copyright (C) 2019 Alireza Rashti.
*/


#include "bbn_headers.h"


void bbn_free_data_KS_trKij(Patch_T *const patch)
{
  const unsigned nn = patch->nn;
  unsigned ijk;

  /* declaring: */
  READ_v(KSgammaI_U2U2)
  READ_v(KSgammaI_U1U1)
  READ_v(KSgammaI_U1U2)
  READ_v(KSgammaI_U0U0)
  READ_v(KSgammaI_U0U1)
  READ_v(KSgammaI_U0U2)
  READ_v(KSGamma_U1D0D0)
  READ_v(KSGamma_U0D2D2)
  READ_v(KSGamma_U1D0D2)
  READ_v(KSGamma_U1D0D1)
  READ_v(KSGamma_U2D1D2)
  READ_v(KSGamma_U0D1D1)
  READ_v(KSGamma_U2D0D0)
  READ_v(KSGamma_U1D1D2)
  READ_v(KSGamma_U2D0D1)
  READ_v(KSGamma_U2D0D2)
  READ_v(KSGamma_U0D0D1)
  READ_v(KSGamma_U0D0D0)
  READ_v(KSGamma_U0D1D2)
  READ_v(KSGamma_U0D0D2)
  READ_v(KSGamma_U2D2D2)
  READ_v(KSGamma_U1D1D1)
  READ_v(KSGamma_U2D1D1)
  READ_v(KSGamma_U1D2D2)
  READ_v(KSB_D1)
  READ_v(KSB_D0)
  READ_v(KSB_D2)
  READ_v(KSalpha)
  REALLOC_v_CALL_v(K)
  READ_v(dKSB_D2D0)
  READ_v(dKSB_D0D0)
  READ_v(dKSB_D2D2)
  READ_v(dKSB_D0D1)
  READ_v(dKSB_D0D2)
  READ_v(dKSB_D1D2)
  READ_v(dKSB_D1D1)
  READ_v(dKSB_D1D0)
  READ_v(dKSB_D2D1)


    for(ijk = 0; ijk < nn; ++ijk)
    {
    double DB_D0D2 = 
-KSB_D0[ijk]*KSGamma_U0D0D2[ijk] - KSB_D1[ijk]*KSGamma_U1D0D2[ijk] - 
KSB_D2[ijk]*KSGamma_U2D0D2[ijk] + dKSB_D0D2[ijk];

    double DB_D0D0 = 
-KSB_D0[ijk]*KSGamma_U0D0D0[ijk] - KSB_D1[ijk]*KSGamma_U1D0D0[ijk] - 
KSB_D2[ijk]*KSGamma_U2D0D0[ijk] + dKSB_D0D0[ijk];

    double DB_D0D1 = 
-KSB_D0[ijk]*KSGamma_U0D0D1[ijk] - KSB_D1[ijk]*KSGamma_U1D0D1[ijk] - 
KSB_D2[ijk]*KSGamma_U2D0D1[ijk] + dKSB_D0D1[ijk];

    double DB_D2D0 = 
-KSB_D0[ijk]*KSGamma_U0D0D2[ijk] - KSB_D1[ijk]*KSGamma_U1D0D2[ijk] - 
KSB_D2[ijk]*KSGamma_U2D0D2[ijk] + dKSB_D2D0[ijk];

    double DB_D2D1 = 
-KSB_D0[ijk]*KSGamma_U0D1D2[ijk] - KSB_D1[ijk]*KSGamma_U1D1D2[ijk] - 
KSB_D2[ijk]*KSGamma_U2D1D2[ijk] + dKSB_D2D1[ijk];

    double DB_D2D2 = 
-KSB_D0[ijk]*KSGamma_U0D2D2[ijk] - KSB_D1[ijk]*KSGamma_U1D2D2[ijk] - 
KSB_D2[ijk]*KSGamma_U2D2D2[ijk] + dKSB_D2D2[ijk];

    double DB_D1D2 = 
-KSB_D0[ijk]*KSGamma_U0D1D2[ijk] - KSB_D1[ijk]*KSGamma_U1D1D2[ijk] - 
KSB_D2[ijk]*KSGamma_U2D1D2[ijk] + dKSB_D1D2[ijk];

    double DB_D1D1 = 
-KSB_D0[ijk]*KSGamma_U0D1D1[ijk] - KSB_D1[ijk]*KSGamma_U1D1D1[ijk] - 
KSB_D2[ijk]*KSGamma_U2D1D1[ijk] + dKSB_D1D1[ijk];

    double DB_D1D0 = 
-KSB_D0[ijk]*KSGamma_U0D0D1[ijk] - KSB_D1[ijk]*KSGamma_U1D0D1[ijk] - 
KSB_D2[ijk]*KSGamma_U2D0D1[ijk] + dKSB_D1D0[ijk];

    double Kij_D2D2 = 
DB_D2D2/KSalpha[ijk];

    double Kij_D0D1 = 
0.5*(DB_D0D1 + DB_D1D0)/KSalpha[ijk];

    double Kij_D0D0 = 
DB_D0D0/KSalpha[ijk];

    double Kij_D0D2 = 
0.5*(DB_D0D2 + DB_D2D0)/KSalpha[ijk];

    double Kij_D1D1 = 
DB_D1D1/KSalpha[ijk];

    double Kij_D1D2 = 
0.5*(DB_D1D2 + DB_D2D1)/KSalpha[ijk];

    double trK = 
KSgammaI_U0U0[ijk]*Kij_D0D0 + 2.0*KSgammaI_U0U1[ijk]*Kij_D0D1 + 2.0*
KSgammaI_U0U2[ijk]*Kij_D0D2 + KSgammaI_U1U1[ijk]*Kij_D1D1 + 2.0*
KSgammaI_U1U2[ijk]*Kij_D1D2 + KSgammaI_U2U2[ijk]*Kij_D2D2;

    K[ijk] = trK;
    }/*end of for(ijk = 0; ijk < nn; ++ijk)*/
}
